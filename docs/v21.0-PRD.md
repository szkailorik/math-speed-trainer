# v21.0 PRD: æ¨¡å—å·®å¼‚åŒ–å¥–åŠ±ç³»ç»Ÿ â€” "å…­ç•Œå¯»å®"

## 1. é—®é¢˜è¯Šæ–­

### å½“å‰çŠ¶æ€

| ç³»ç»Ÿ | æ˜¯å¦æ¨¡å—å·®å¼‚åŒ– | è¯¦æƒ… |
|------|---------------|------|
| å¦–æ€ª | **å·²æœ‰** | 6å¥—ç‹¬ç«‹å¦–æ€ªï¼ˆå±±æµ·ç»/HP/èŠæ–‹/è¥¿æ¸¸è®°/å°ç¥æ¦œ/åŸºç¡€ï¼‰ |
| å¡ç‰Œ | **å·²æœ‰** | 143å¼ å¡ï¼Œæ¯æ¨¡å—19å¼ +è·¨æ¨¡å—10å¼ ï¼Œæ‰è½ä¼˜å…ˆå½“å‰æ¨¡å— |
| é“å…· | **æœªå·®å¼‚åŒ–** | 18ä¸ªé€šç”¨é“å…·ï¼Œæ‰€æœ‰æ¨¡å—åŒä¸€ä¸ªæ± å­ |
| æ­¦å™¨ | **æœªå·®å¼‚åŒ–** | 8ç§é€šç”¨æ­¦å™¨ï¼Œæ‰€æœ‰æ¨¡å—åŒä¸€ä¸ªæ± å­ |
| æˆå°± | **éƒ¨åˆ†** | æˆå°±ä¸»è¦åŸºäºæ•°é‡/è¿å‡»ï¼Œç¼ºå°‘æ¨¡å—æŒæ¡ç±»æˆå°± |

### æ ¸å¿ƒé—®é¢˜

ç©å®¶åªéœ€åå¤åˆ·å°ä¹ä¹ï¼ˆæœ€ç®€å•çš„æ¨¡å—ï¼‰å°±èƒ½è·å¾—æ‰€æœ‰é“å…·å’Œæ­¦å™¨ã€‚æ²¡æœ‰åŠ¨åŠ›å»æŒ‘æˆ˜åˆ†æ•°ã€å°æ•°ç­‰æ›´éš¾çš„æ¨¡å—ã€‚è¿™è¿åäº†æ¸¸æˆè®¾è®¡ä¸­"åŒºåŸŸç‹¬å èµ„æºé©±åŠ¨æ¢ç´¢"çš„æ ¸å¿ƒåŸåˆ™ã€‚

---

## 2. è®¾è®¡çµæ„Ÿï¼ˆç»å…¸æ¸¸æˆè°ƒç ”ï¼‰

### 2.1 å®å¯æ¢¦ï¼ˆPokemonï¼‰â€” åŒºåŸŸç‹¬å ç”Ÿç‰©

**æœºåˆ¶**: æ¯ä¸ªåœ°åŒºæœ‰ç‹¬å å®å¯æ¢¦ï¼ŒæŸäº›åªåœ¨ç‰¹å®šåœ°åŒºå‡ºç°ã€‚
- å¸¸è§å®å¯æ¢¦åˆ°å¤„éƒ½æ˜¯ï¼ˆæ³¢æ³¢ã€å°æ‹‰è¾¾ï¼‰â†’ é€šç”¨æ‰è½
- ç¨€æœ‰å®å¯æ¢¦åŒºåŸŸç‹¬å ï¼ˆçš®å¡ä¸˜åªåœ¨å¸¸ç£æ£®æ—ï¼‰â†’ æ¨¡å—ç‹¬å 
- ä¼ è¯´å®å¯æ¢¦éœ€è¦è·¨åŒºåŸŸé“å…·è§£é” â†’ è·¨æ¨¡å—è”åŠ¨

**å€Ÿé‰´**: æ¯ä¸ªæ¨¡å—æœ‰ç‹¬å ç¨€æœ‰é“å…·ï¼Œé€šç”¨é“å…·æ‰€æœ‰æ¨¡å—éƒ½æœ‰ã€‚

### 2.2 æ€ªç‰©çŒäººï¼ˆMonster Hunterï¼‰â€” ç´ æé©±åŠ¨è£…å¤‡

**æœºåˆ¶**: æ¯ç§æ€ªç‰©æ‰è½ç‹¬ç‰¹ç´ æï¼Œç”¨äºåˆ¶ä½œç‰¹å®šè£…å¤‡ã€‚
- ç«é¾™ç´ æ â†’ ç«é¾™å¤ªåˆ€ â†’ å…‹åˆ¶å†°é¾™
- ç©å®¶ä¸ºäº†åˆ¶ä½œç‰¹å®šè£…å¤‡ï¼Œä¸»åŠ¨å»ç‹©çŒç‰¹å®šæ€ªç‰©

**å€Ÿé‰´**: æ¨¡å—ç‹¬å é“å…·å¯ä»¥åœ¨å…¶ä»–æ¨¡å—å‘æŒ¥å¢å¼ºæ•ˆæœï¼ˆè·¨æ¨¡å—å¢ç›Šï¼‰ã€‚

### 2.3 æš—é»‘ç ´åç¥ï¼ˆDiabloï¼‰â€” åŒºåŸŸæ‰è½è¡¨ + ç¨€æœ‰åº¦åˆ†å±‚

**æœºåˆ¶**:
- æ¯ä¸ªåŒºåŸŸæœ‰ç‹¬ç«‹çš„æ‰è½è¡¨ï¼ˆLoot Tableï¼‰
- ç¨€æœ‰åº¦åˆ†å±‚ï¼šæ™®é€šâ†’é­”æ³•â†’ç¨€æœ‰â†’æš—é‡‘â†’å¤ªå¤
- Boss æœ‰ç‹¬å æ‰è½ï¼ˆBoss Lootï¼‰
- æš—é‡‘è£…å¤‡åªåœ¨ç‰¹å®šåŒºåŸŸ/éš¾åº¦æ‰è½

**å€Ÿé‰´**: ä¼ è¯´çº§é“å…·åªåœ¨ç‰¹å®šæ¨¡å— + ç‰¹å®šéš¾åº¦æ‰è½ã€‚

### 2.4 å¡å°”è¾¾ï¼ˆZelda: TotKï¼‰â€” ç´ ææ”¶é›† + åˆæˆ

**æœºåˆ¶**: ä¸åŒåŒºåŸŸæœ‰ä¸åŒç´ æï¼Œç»„åˆæˆä¸åŒæ•ˆæœã€‚
- æµ·æ‹‰é²å¹³åŸï¼šè‹¹æœã€è˜‘è‡
- æ ¼é²å¾·æ²™æ¼ ï¼šä¼ç‰¹æœã€å†°å†·çš„é²‘é±¼
- ç´ æå¯ä»¥è‡ªç”±ç»„åˆçƒ¹é¥ª

**å€Ÿé‰´**: è·¨æ¨¡å—æ”¶é›†ç‰¹å®šé“å…·å¯ä»¥"åˆæˆ"æ›´å¼ºåŠ›çš„è£…å¤‡ã€‚

### 2.5 Kingdom Hearts â€” ä¸–ç•Œç‹¬å èƒ½åŠ›

**æœºåˆ¶**: æ¯ä¸ªè¿ªå£«å°¼ä¸–ç•Œç»™äºˆç‹¬ç‰¹çš„å…±é¸£ï¼ˆTrinityï¼‰æˆ–å¬å”¤èƒ½åŠ›ã€‚
- ç©å®¶å¿…é¡»è®¿é—®æ‰€æœ‰ä¸–ç•Œæ‰èƒ½è·å¾—å®Œæ•´èƒ½åŠ›é›†ã€‚
- æŸäº› Boss éœ€è¦ç‰¹å®šä¸–ç•Œçš„èƒ½åŠ›æ‰èƒ½å‡»è´¥ã€‚

**å€Ÿé‰´**: æ¨¡å—ç‹¬å é“å…·åœ¨ç‰¹å®šæˆ˜æ–—ä¸­å‘æŒ¥å…³é”®ä½œç”¨ã€‚

### 2.6 æ•™è‚²æ¸¸æˆè°ƒç ”

**Prodigy Math**: ä¸åŒåŒºåŸŸæœ‰ç‹¬ç‰¹å® ç‰©å’Œè£…å¤‡ï¼Œé©±åŠ¨å­©å­æ¢ç´¢æ‰€æœ‰æ•°å­¦é¢†åŸŸã€‚
**DragonBox**: æ¯ç« è§£é”æ–°æœºåˆ¶ï¼Œå‰ç« çŸ¥è¯†æ˜¯åç« åŸºç¡€ã€‚
**Khan Academy**: æŠ€èƒ½æ ‘ç»“æ„ï¼Œéœ€è¦å…ˆæŒæ¡åŸºç¡€æ‰èƒ½è§£é”é«˜çº§å†…å®¹ã€‚

**ç ”ç©¶ç»“è®º**:
- 6-10å²å„¿ç«¥å¯¹"æ”¶é›†"æœ‰å¤©ç„¶çƒ­æƒ…ï¼ˆPokÃ©monæ•ˆåº”ï¼‰
- ç‹¬å å¥–åŠ±æ¯”éš¾åº¦æƒ©ç½šæ›´èƒ½é©±åŠ¨æ¢ç´¢ï¼ˆæ­£å‘æ¿€åŠ± > è´Ÿå‘æƒ©ç½šï¼‰
- è·¨æ¨¡å—è”åŠ¨è®©å­©å­æ„Ÿè§‰"æ¯æ¬¡å­¦ä¹ éƒ½æœ‰æ„ä¹‰"

---

## 3. æ ¸å¿ƒè®¾è®¡

### 3.1 æ¨¡å—ç‹¬å é“å…·ç³»ç»Ÿ

æ¯ä¸ªæ¨¡å—é™¤äº†å…±äº«é€šç”¨é“å…·å¤–ï¼Œå¢åŠ  **3ä¸ªç‹¬å é“å…·**ï¼ˆ1ç¨€æœ‰+1å²è¯—+1ä¼ è¯´ï¼‰ã€‚

| æ¨¡å— | ç‹¬å é“å…·ï¼ˆç¨€æœ‰ï¼‰ | ç‹¬å é“å…·ï¼ˆå²è¯—ï¼‰ | ç‹¬å é“å…·ï¼ˆä¼ è¯´ï¼‰ |
|------|-----------------|-----------------|-----------------|
| å°ä¹ä¹ | ä¹ä¹æŠ¤ç¬¦ ğŸ“¿ (è¿å‡»+3) | ä¹˜æ³•ä¹‹çœ¼ ğŸ‘ï¸ (çœ‹ç©¿é—ªé¿) | å£è¯€å¤©ä¹¦ ğŸ“œ (å…¨å±æ€§+1) |
| å¤§ä¹ä¹ | é­”æ³•æ°´æ™¶çƒ ğŸ”® (æš´å‡»+30%) | åˆ†é™¢å¸½ ğŸ© (é€‰æ‹©æœ€ä¼˜æ­¦å™¨) | è€é­”æ– ğŸª„ (ä¼¤å®³Ã—2ä¸€æ¬¡) |
| ä¹˜æ³•é€Ÿè®° | ç‹ä»™é¢å…· ğŸ­ (é—ªé¿1æ¬¡æ”»å‡») | èŠæ–‹å¤å· ğŸ“• (å¤æ´»+1HP) | ç”»çš® ğŸ–¼ï¸ (å˜èº«æ— æ•Œ3é¢˜) |
| åˆ†æ•° | ç²¾å«ä¹‹çŸ³ ğŸª¨ (æŠ¤ç›¾+2) | å‡¤å‡°ä¹‹ç¾½ ğŸª¶ (æ­»äº¡æ—¶å¤æ´»æ»¡è¡€) | å±±æµ·å®é‰´ ğŸ“– (æ‰€æœ‰ä¼¤å®³+3) |
| å°æ•° | é‡‘ç®æ£’ç¢ç‰‡ ğŸ® (æ”»å‡»+2è¿ç»­3æ¬¡) | å®šæµ·ç¥é’ˆÂ·ç¼© ğŸ“Œ (æ€ªç‰©æ”»å‡»å‡åŠ) | å¦‚æ„é‡‘ç®æ£’ ğŸ”± (å…¨åœºä¼¤å®³Ã—1.5) |
| å•ä½æ¢ç®— | é£ç«è½®ç¢ç‰‡ ğŸ’« (åŠ é€Ÿ+2s) | æ‰“ç¥é­ âš¡ (æ— è§†æ€ªç‰©é˜²å¾¡) | å°ç¥æ¦œ ğŸ“‹ (ä¸€å‡»å¿…æ€HPâ‰¤3æ€ªç‰©) |

### 3.2 æ¨¡å—ç‹¬å æ­¦å™¨

æ¯ä¸ªæ¨¡å—å¢åŠ  **2ç§ç‹¬å æ­¦å™¨**ï¼Œåªåœ¨è¯¥æ¨¡å—æˆ˜æ–—ä¸­ä½¿ç”¨ã€‚

| æ¨¡å— | ç‹¬å æ­¦å™¨1 | ç‹¬å æ­¦å™¨2 |
|------|----------|----------|
| å°ä¹ä¹ | ä¹è½¬ä»™ä¸¹ ğŸ’Š (æ²»ç–—+æ”»å‡») | ç®—ç›˜ç  ğŸ§® (è¿å‡»åŠ æˆÃ—2) |
| å¤§ä¹ä¹ | å®ˆæŠ¤ç¥å…½ ğŸ¦‰ (è¿½è¸ªæ”»å‡») | é­”å’’ä¹‹å…‰ âœ¨ (èŒƒå›´æ”»å‡») |
| ä¹˜æ³•é€Ÿè®° | é¬¼ç« ğŸ‘» (æŒç»­ä¼¤å®³) | ç‹ç‹¸ç« ğŸ¦Š (ç©¿é€æ”»å‡») |
| åˆ†æ•° | ç¥å…½å’†å“® ğŸ² (éœ‡æ…‘+ä¼¤å®³) | çµç¬¦ ğŸ“› (å°å°æ€ªç‰©è¡Œä¸º) |
| å°æ•° | ç´§ç®å’’ â­• (æŸç¼š+ä¼¤å®³) | ä¸ƒåäºŒå˜ ğŸ’ (éšæœºé«˜ä¼¤æ­¦å™¨) |
| å•ä½æ¢ç®— | å¤©é›· ğŸŒ©ï¸ (å…¨ä½“ä¼¤å®³) | åœŸéæœ¯ ğŸŒ€ (é—ªé¿+åå‡») |

### 3.3 æ¨¡å—æŒæ¡æˆå°±

æ¯ä¸ªæ¨¡å—å¢åŠ  **4ä¸ªæŒæ¡ç±»æˆå°±**ï¼š

1. **å…¥é—¨** â€” è¯¥æ¨¡å—å®Œæˆ10åœºæˆ˜æ–—
2. **ç²¾é€š** â€” è¯¥æ¨¡å—è¾¾æˆ30è¿å‡»
3. **å¤§å¸ˆ** â€” è¯¥æ¨¡å—å›°éš¾éš¾åº¦é€šå…³
4. **ä¼ è¯´** â€” è¯¥æ¨¡å—æ”¶é›†å…¨éƒ¨ç‹¬å é“å…·

### 3.4 è·¨æ¨¡å—è”åŠ¨å¥–åŠ±

**å…­ç•Œä¹‹é’¥**: åœ¨6ä¸ªæ¨¡å—å„å®Œæˆè‡³å°‘1åœºæˆ˜æ–—ï¼ˆå›°éš¾ï¼‰åè§£é”ï¼š
- ç‰¹æ®Šæˆå°±"å…­ç•Œé€šè¡Œè€…"
- è§£é”è·¨æ¨¡å—ä¼ è¯´æ­¦å™¨"æ··æ²Œä¹‹åˆƒ"
- å…¨æ¨¡å—é“å…·æ‰è½ç‡æ°¸ä¹…+5%

**ç´ æåˆæˆæç¤º**ï¼ˆä»…UIå±•ç¤ºï¼Œä¸å®é™…å®ç°åˆæˆç³»ç»Ÿâ€”â€”ä¿æŒç®€å•ï¼‰:
- é“å…·æè¿°ä¸­æ ‡æ³¨"åœ¨XXæ¨¡å—ä¸­æ•ˆæœåŠ å€"
- é¼“åŠ±ç©å®¶åœ¨ä¸åŒæ¨¡å—ä½¿ç”¨å…¶ä»–æ¨¡å—çš„é“å…·

### 3.5 æ‰è½ç‡å·®å¼‚åŒ–

| æ¨¡å— | é€šç”¨é“å…·æ‰è½ç‡ | ç‹¬å é“å…·æ‰è½ç‡ | Bossç‹¬å æ‰è½ç‡ |
|------|--------------|--------------|---------------|
| å°ä¹ä¹ | 15% (åŸºç¡€) | 8% | 25% |
| å¤§ä¹ä¹ | 13% | 10% | 30% |
| ä¹˜æ³•é€Ÿè®° | 12% | 12% | 35% |
| åˆ†æ•° | 10% | 15% | 40% |
| å°æ•° | 10% | 15% | 40% |
| å•ä½æ¢ç®— | 10% | 15% | 40% |

**è®¾è®¡æ„å›¾**: éš¾åº¦è¶Šé«˜çš„æ¨¡å—ï¼Œç‹¬å é“å…·æ‰è½ç‡è¶Šé«˜ï¼Œè¡¥å¿éš¾åº¦å·®å¼‚ã€‚

---

## 4. æŠ€æœ¯å®ç°

### 4.1 battle-data.js â€” æ¨¡å—é“å…·æ± 

```javascript
// æ›¿æ¢å•ä¸€ items æ•°ç»„ä¸ºæ¨¡å—æ˜ å°„
moduleItems: {
    shared: [ /* ä¿ç•™åŸ18ä¸ªé€šç”¨é“å…· */ ],
    xiaojiujiu: [ /* 3ä¸ªç‹¬å é“å…· */ ],
    times: [ /* 3ä¸ªç‹¬å é“å…· */ ],
    // ...
},

moduleWeapons: {
    shared: [ /* ä¿ç•™åŸ8ä¸ªé€šç”¨æ­¦å™¨ */ ],
    xiaojiujiu: [ /* 2ä¸ªç‹¬å æ­¦å™¨ */ ],
    // ...
}
```

### 4.2 battle-combat.js â€” æ‰è½é€»è¾‘

```javascript
BattleMode.getRandomItem = function() {
    var module = App.battle.module || 'xiaojiujiu';
    var shared = BattleMode.moduleItems.shared;
    var exclusive = BattleMode.moduleItems[module] || [];

    // 30% æ¦‚ç‡ä»ç‹¬å æ± æ‰è½ï¼Œ70% ä»å…±äº«æ± 
    var pool, isExclusive = false;
    if (exclusive.length > 0 && Math.random() < 0.3) {
        pool = exclusive;
        isExclusive = true;
    } else {
        pool = shared;
    }

    // æŒ‰ç¨€æœ‰åº¦åŠ æƒ
    return weightedRandomItem(pool);
};
```

### 4.3 data.js â€” æ¨¡å—æˆå°±

```javascript
// æ¯æ¨¡å—4ä¸ªæˆå°±
{ id: 'xiaojiujiu_10', name: 'ä¹˜æ³•å…¥é—¨', desc: 'å°ä¹ä¹æ¨¡å—å®Œæˆ10åœºæˆ˜æ–—', icon: 'ğŸŒ±', special: 'module_10', module: 'xiaojiujiu' },
{ id: 'xiaojiujiu_combo30', name: 'ä¹˜æ³•ç²¾é€š', desc: 'å°ä¹ä¹æ¨¡å—è¾¾æˆ30è¿å‡»', icon: 'ğŸ”¥', special: 'module_combo30', module: 'xiaojiujiu' },
// ... å…± 24 ä¸ªæ–°æˆå°± (6æ¨¡å—Ã—4)
// + 1ä¸ªè·¨æ¨¡å—"å…­ç•Œé€šè¡Œè€…"
```

---

## 5. æ–‡ä»¶å˜æ›´æ¸…å•

| æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|
| `js/battle-data.js` | **å¤§æ”¹**: æ–°å¢ moduleItems(18ä¸ªç‹¬å é“å…·) + moduleWeapons(12ä¸ªç‹¬å æ­¦å™¨) + moduleDropConfig |
| `js/battle-combat.js` | **ä¸­æ”¹**: getRandomItemæ”¹ç”¨æ¨¡å—æ± ã€tryDropItemåŠ ç‹¬å é€»è¾‘ã€æ­¦å™¨é€‰æ‹©åŠ æ¨¡å—è¿‡æ»¤ |
| `js/data.js` | **å°æ”¹**: æ–°å¢25ä¸ªæˆå°±(6Ã—4æ¨¡å—+1è·¨æ¨¡å—) |
| `js/ui-pages.js` | **å°æ”¹**: æˆå°±æ¸²æŸ“æ”¯æŒmoduleå­—æ®µ |
| `index.html` | **å°æ”¹**: ç‰ˆæœ¬å·æ›´æ–° |

---

## 6. éªŒè¯æ¸…å•

- [ ] å°ä¹ä¹æ¨¡å—æ‰è½çš„ç‹¬å é“å…·ä¸ä¼šåœ¨åˆ†æ•°æ¨¡å—å‡ºç°
- [ ] åˆ†æ•°æ¨¡å—çš„ç‹¬å æ‰è½ç‡(15%)é«˜äºå°ä¹ä¹(8%)
- [ ] Bossæˆ˜æœ‰æ›´é«˜çš„ç‹¬å é“å…·æ‰è½ç‡
- [ ] æ¨¡å—æ­¦å™¨åªåœ¨å¯¹åº”æ¨¡å—ä¸­å‡ºç°
- [ ] æ”¶é›†å…¨éƒ¨ç‹¬å é“å…·è§¦å‘"ä¼ è¯´"æˆå°±
- [ ] 6æ¨¡å—å„å›°éš¾é€šå…³åè§¦å‘"å…­ç•Œé€šè¡Œè€…"
- [ ] æ‰€æœ‰é“å…·çš„æè¿°åŒ…å«è·å–é€”å¾„æç¤º
- [ ] åŸæœ‰18ä¸ªé€šç”¨é“å…·ä»ç„¶åœ¨æ‰€æœ‰æ¨¡å—å¯è·å¾—

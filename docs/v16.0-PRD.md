# v16.0 PRD: 战斗体验深度打磨 + 试炼之塔

> 版本: v16.0 Draft v1
> 基础版本: v15.0 (第三人称对战 + 行为系统 + 卡牌收集)
> 日期: 2026-02-10
> 状态: 待产品经理打磨

---

## 一、版本目标

v15.0 建立了第三人称对战框架（舞台布局、行为系统、卡牌收集），但战斗体验仍然"骨架感"较强——主角只是一个 emoji 在浮动，怪物行为偏呆板，连击缺乏爽感。v16.0 的核心目标是**把骨架变成血肉**：

1. **主角视觉升级**：从单 emoji 进化为多部件角色（身体+武器+特效层），攻击有明确的起手、施放、命中三段演出
2. **连击系统重做**：连击不再只是数字变化，而是攻击模式的质变——连续攻击、蓄力一击、终结技演出
3. **怪物行为2.0**：新增 5 种行为 + 现有行为视觉增强，怪物在战斗中有"性格"，不再是木桩
4. **试炼之塔**：全新混合题型战斗模式，独立主题怪物群，最高难度 + 最好掉率，塔层递进机制
5. **每模块扩充怪物**：每模块再新增 8-10 只怪物，增强遭遇多样性

---

## 二、核心改动一：主角视觉系统升级

### 2.1 当前现状（v15.0）

```
主角区域：
  🧙  <- 单个 emoji，只有 CSS 浮动动画
 勇者  <- 用户名
❤️❤️❤️  <- 血条

攻击流程：
  🧙 → (施法光效 0.3s) → 🔥飞向怪物 → 结束
  整个过程约 0.6s，打击感不足
```

**问题**：
- 主角只是一个 emoji，没有"角色"感
- 攻击动画太短太单一，每次答对都一样
- 连击 3 次和连击 15 次的攻击看起来完全一样（只是数字不同）
- 没有蓄力、没有终结技、没有节奏变化

### 2.2 目标方案：多层角色系统

```
主角区域（三层结构）：
  ┌──────────────┐
  │   ✨ 特效层   │  <- 光环/火焰/雷电等（连击高时出现）
  │   🧙 角色层   │  <- 主角 emoji（有丰富动作状态）
  │   ⚔️ 武器层   │  <- 当前武器悬浮在角色旁（连击不同武器不同）
  └──────────────┘
  勇者  <- 用户名
  ❤️❤️❤️ <- 血条
```

### 2.3 主角状态进化系统

根据连击数，主角外观和攻击模式**逐步升级**：

| 连击阶段 | 连击数 | 主角外观 | 武器 | 攻击模式 | 特效层 |
|----------|--------|----------|------|----------|--------|
| **普通** | 0-2 | 🧙 正常 | 当前武器 | 单发攻击 | 无 |
| **觉醒** | 3-4 | 🧙 微光边框 | 🔥 火焰附魔 | 快速两连击 | 微弱火星 |
| **战意** | 5-9 | 🧙‍♂️ 蓝光边框 | ⚡ 雷电附魔 | 三连斩 + 尾刀 | 电弧环绕 |
| **超神** | 10-14 | 🧙‍♂️ 金光脉冲 | 💎 宝石武器 | 蓄力斩（大伤害特写） | 金色粒子旋转 |
| **无敌** | 15+ | 🧙‍♂️ 彩虹光环 | 🌟 星辰武器 | 终结技（全屏演出 1.5s） | 星辰光幕 + 屏幕震动 |

### 2.4 攻击动画序列升级

#### 普通攻击（连击 0-2）
```
[答对] → 主角举手 (0.15s)
       → 武器飞出 (0.3s)
       → 命中怪物 + 伤害数字 (0.2s)
       总时长: 0.65s（与当前持平）
```

#### 两连击（连击 3-4）
```
[答对] → 主角向右冲刺 (0.15s)
       → 武器1 飞出 (0.2s) → 命中 + "-1"
       → 武器2 紧跟飞出 (0.15s) → 命中 + "-1"
       → 主角回位 (0.15s)
       总时长: 0.65s（紧凑不拖沓）
```

#### 三连斩 + 尾刀（连击 5-9）
```
[答对] → 主角瞬移到中央 (0.1s)
       → 斩击1 (0.1s) → 斩击2 (0.1s) → 斩击3 (0.1s)
       → 每斩击伴随刀光轨迹残影
       → 尾刀蓄力 (0.15s) → 重击 + 大伤害数字 (0.2s)
       → 主角回位 (0.1s)
       总时长: 0.85s（节奏快但有高潮）
```

#### 蓄力斩（连击 10-14）
```
[答对] → 全屏微暗 (0.1s)
       → 主角蓄力（缩小→放大 + 能量聚集粒子）(0.3s)
       → 释放巨大武器（占舞台宽度 40%）飞向怪物 (0.3s)
       → 爆炸特效 + 大伤害数字 + 屏幕震动 (0.3s)
       → 恢复 (0.1s)
       总时长: 1.1s（有停顿的节奏感）
```

#### 终结技（连击 15+）
```
[答对] → 屏幕闪白 (0.1s)
       → 主角飞至舞台中央放大 (0.2s)
       → 技能名称闪现（如"星辰一击！"）(0.3s)
       → 彩虹光柱从主角冲向怪物 (0.4s)
       → 全屏爆炸 + 粒子盛宴 (0.3s)
       → 恢复 + 伤害数字 (0.2s)
       总时长: 1.5s（一局最多触发 1-2 次的大招感）
```

### 2.5 受击动画升级

当前主角受击只是"向左弹退+闪红"。升级为：

| 受击情况 | 动画 |
|----------|------|
| 普通受击 | 主角后退 + 防御姿态 + 红色数字 |
| 连续受击（连续答错2+） | 主角跪地 + 喘息 + 碎屑粒子 |
| 致命一击（HP=1时受击） | 慢动作 + 屏幕变暗 + 心跳音效 |
| 被护盾挡住 | 盾牌emoji出现 + 反弹特效 + "叮!" |
| 复活草救命 | 主角倒下 → 绿光环绕 → 站起 + 🌿特效 |

---

## 三、核心改动二：连击系统重做

### 3.1 当前现状（v15.0）

```javascript
// 当前连击效果：
combo 3:  🔥三连击!  + 音效
combo 5:  ⚡五连击!  + 音效 + confetti(20)
combo 10: 💥十连斩!! + 音效 + confetti(20)
combo 15: 🌟超神!!!  + 音效 + confetti(30)
combo 20: 👑无敌!    + （同上）
```

**问题**：连击只有文字和粒子，攻击方式本身没有变化

### 3.2 连击系统2.0设计

#### 连击变化维度

| 维度 | 普通(0-2) | 觉醒(3-4) | 战意(5-9) | 超神(10-14) | 无敌(15+) |
|------|-----------|-----------|-----------|-------------|-----------|
| **攻击次数** | 1次 | 2连击 | 3+尾刀 | 蓄力斩 | 终结技 |
| **攻击速度** | 正常 | 1.2x | 1.5x | 有节奏停顿 | 慢动作特写 |
| **伤害显示** | 白色 -1 | 橙色 -1 -1 | 蓝色连续弹出 | 金色大字 | 彩虹色特大字 |
| **音效** | 单音 | 双音 | 三连音 | 蓄力+释放 | 完整音乐片段 |
| **屏幕效果** | 无 | 微震 | 中震 | 闪光+强震 | 全屏演出 |
| **怪物反应** | 普通受击 | 连续后退 | 惊慌表情 | 飞出画面边缘 | 粉碎爆炸 |

#### 连击断裂惩罚

当前答错只是 combo 归零。升级为视觉/音效反馈：

```
[连击断裂] → 主角头顶连击火焰熄灭 (0.3s)
           → 碎裂音效 (类似玻璃碎裂)
           → 连击数字碎裂动画（数字分裂散开）(0.5s)
           → 主角回到普通状态
```

#### 连击计数器视觉升级

```
当前: 🔥连击 3
升级为:
  ┌─────────────────┐
  │  🔥×3  觉醒!     │  <- 带颜色背景 + 火焰粒子边框
  │  ████████░░░░░   │  <- 进度条（到下一阶段的进度）
  └─────────────────┘
```

### 3.3 连击保护机制

为避免高连击被意外中断带来的挫败感：

- **连击护盾**：连击 >= 10 时，第一次答错不清零连击，改为 combo - 3（并消耗一个视觉"护盾层"）
- **视觉预警**：连击护盾被消耗时，屏幕边缘闪红 + "危险!" 提示
- **追忆连击**：答错后如果下一题立即答对，恢复 50% 连击数（向下取整）

---

## 四、核心改动三：怪物行为 2.0

### 4.1 当前行为回顾（v15.0 的 9 种）

| 行为 | 视觉表现 | 评价 |
|------|----------|------|
| 闪避 | 右滑 + 半透明 | ⭐⭐ 基础但可用 |
| 嘲讽 | 气泡台词 | ⭐ 太简单，只有文字 |
| 愤怒 | 变红 + 脉冲 | ⭐⭐ 效果还行 |
| 恐惧 | 颤抖 | ⭐ 不够明显 |
| 防御 | 微放大 + 亮度 | ⭐ 几乎看不出来 |
| 召唤 | 👾emoji出现 | ⭐ 太简陋 |
| 逃跑 | 翻转跑 | ⭐⭐ 有趣但太快 |
| 自爆 | 屏幕闪 | ⭐⭐ 需要更震撼 |
| 治愈 | 绿光 | ⭐ 基础 |

### 4.2 现有行为视觉增强

| 行为 | 当前效果 | v16.0 升级 |
|------|----------|------------|
| **闪避** | 右滑 | 残影分身（3个虚影）+ 嘲笑音效 + "miss!" 大字 |
| **嘲讽** | 气泡 | 怪物做挑衅动作（跳+转身）+ 嘲讽表情包 + 怒气音效 |
| **愤怒** | 变红 | 背景变暗红 + 怪物放大 1.3x + 周围火焰粒子 + 台词框变红 |
| **恐惧** | 颤抖 | 怪物缩小 0.8x + 后退 + 冒汗💦 + 腿抖动画 + 求饶台词 |
| **防御** | 微放大 | 实体盾牌 🛡️ 出现在怪物前方 + 防御蓝光 + "叮叮"拦截音效 |
| **召唤** | 👾出现 | 魔法阵出现在地面 + 小怪从阵中爬出 + 黑雾弥漫 + 轰鸣音效 |
| **逃跑** | 翻转 | 烟雾弹💨 + 留下空壳 + 脚印消失 + 滑稽音效 |
| **自爆** | 屏幕闪 | 倒计时3-2-1 + 怪物膨胀 + 全屏爆炸💥 + 碎片飞散 + 强震 |
| **治愈** | 绿光 | 魔法阵 + 绿色粒子上升 + 伤口愈合动画 + 叮铃音效 |

### 4.3 新增 5 种怪物行为

| 行为 | 触发条件 | 视觉表现 | 游戏影响 |
|------|----------|----------|----------|
| **反击** | 答对后 Boss 10%概率 | 怪物格挡武器 → 反弹回主角 | 主角 -1 HP，下一题伤害+1 补偿 |
| **分裂** | 史莱姆系死亡时 | 怪物一分为二（小号副本）| 需要再答 1 题消灭分裂体 |
| **诅咒** | 暗系怪物答错时 30% | 紫色魔法阵 + 暗雾缠绕主角 | 下 2 题选项变为 5 个（增加干扰项）|
| **护盾** | 钢系怪物 HP<70% | 金属护盾围绕 + 火花弹射 | 下一次攻击无效（需连续答对 2 题破盾）|
| **变身** | 特定Boss第二阶段 | 全屏闪白 → 怪物形态变化 → HP 回满 | Boss 进入第二阶段，行为模式改变 |

### 4.4 怪物行为组合（性格系统）

不再单独触发行为，而是给怪物分配"性格"，性格决定行为偏好：

| 性格 | 行为倾向 | 代表怪物 |
|------|----------|----------|
| **狡猾型** | 闪避30% + 嘲讽频繁 + 逃跑倾向 | 狐狸系、幽灵系 |
| **暴力型** | 愤怒阈值低(70%) + 反击概率高 + 不逃跑 | 龙系、恶魔系 |
| **防御型** | 防御频繁 + 护盾 + 治愈 + 不嘲讽 | 岩石系、钢系 |
| **阴险型** | 诅咒 + 自爆 + 召唤 + 分裂 | 毒系、暗系 |
| **胆小型** | 恐惧阈值低(combo 3) + 逃跑高 + 不反击 | 小动物系 |
| **霸道型** (Boss专属) | 全行为解锁 + 变身 + 召唤 + 防御循环 | Boss怪物 |

---

## 五、核心改动四：试炼之塔

### 5.1 设计理念

试炼之塔是面向高级玩家的**终极挑战模式**。它不属于任何单一模块，而是混合所有模块题目，配以全新的"混沌"主题怪物群。是整个游戏中最难、最刺激，也是获得稀有卡牌概率最高的地方。

### 5.2 塔层结构

```
试炼之塔 (30层)

┌───────────────────────────────┐
│ 🏆 第30层: 塔顶王座            │  <- 最终Boss: 数学魔神
│ 🔥 第29层: 炼狱之火            │
│ ...                           │
│ ⚡ 第21-29层: 炼狱区            │  <- Hard题目，愤怒型+阴险型怪物
│ ─────────────────────────     │
│ ⚔️ 第20层: 中Boss: 混沌守卫     │  <- 中间关卡Boss
│ 🗡️ 第11-19层: 试炼区           │  <- Normal+Hard混合
│ ─────────────────────────     │
│ 🛡️ 第10层: 小Boss: 看门石像     │  <- 第一关卡Boss
│ 📖 第1-9层: 入门区              │  <- Easy+Normal混合
│ ─────────────────────────     │
│ 🚪 入口                        │  <- 需要至少通关 2 个模块才能解锁
└───────────────────────────────┘
```

### 5.3 塔层详细设计（6 模块全覆盖）

试炼之塔的核心设计原则：**所有 6 个模块的题目都必须出现**，且随着塔层递进逐步解锁更多模块，最终在炼狱区和塔顶实现全模块混合。

#### 6 个模块题型速览

| 代号 | 模块名 | 题目范围 |
|------|--------|----------|
| **xiaojiujiu** | 小九九速算 | 1-9 乘除法 (如 6×7=?, 56÷8=?) |
| **times** | 大九九+平方 | 11-19 乘除法 + 平方数 (如 13×14=?, 16²=?) |
| **multiply** | 乘法速记 | 25/50/75/125 系列速算 (如 25×16=?, 125×8=?) |
| **fraction** | 分数小数 | 分数↔小数互换 (如 3/4=?, 0.125=?/?) |
| **decimal** | 小数规律 | ×10/÷100/×1000 移位 (如 3.14×100=?, 250÷1000=?) |
| **unit** | 单位换算 | 长度/质量/体积/货币/时间/面积 (如 3.5km=?m) |

#### 塔层题型分配

| 区域 | 层数 | 题型覆盖 | 难度 | 每层题数 | 怪物HP | 特殊规则 |
|------|------|----------|------|----------|--------|----------|
| **入门区** | 1-3 | xiaojiujiu + decimal | Easy | 3题 | 3 | 热身关，单模块出题 |
| **入门区** | 4-6 | + fraction + unit | Easy+Normal | 3-4题 | 4 | 双模块交替出题 |
| **入门区** | 7-9 | + times + multiply | Normal | 4题 | 4-5 | 4模块随机混合 |
| **门卫Boss** | 10 | 6模块全开 Normal | Normal | 5题 | 8 | 每题来自不同模块，无伤过关给UR加成 |
| **试炼区** | 11-13 | 6模块 Normal | Normal | 4题 | 5-6 | 连续2题同模块则切换 |
| **试炼区** | 14-16 | 6模块 Normal+Hard混合 | Normal+Hard | 4题 | 6 | 每3层怪物变身一次 |
| **试炼区** | 17-19 | 6模块 Hard为主 | Hard | 5题 | 6-7 | Hard题占比70% |
| **中Boss** | 20 | 6模块 Hard | Hard | 6题 | 12 | 两阶段+每阶段锁定3个模块轮流出 |
| **炼狱区** | 21-23 | 6模块 Hard | Hard | 4题 | 7-8 | 2种行为同时激活 |
| **炼狱区** | 24-26 | 6模块 Hard + 跨模块 | Hard | 5题 | 8 | 出现**融合题**（见下方） |
| **炼狱区** | 27-29 | 6模块 Hard + 跨模块 | Hard | 5题 | 8-9 | 融合题比例提高到50% |
| **塔顶** | 30 | 全模块 Hard + 融合题 | Hard | 8题 | 15(三阶段) | 三阶段+全行为+限时90s |

#### 融合题（试炼之塔专属）

从第 24 层开始出现**跨模块融合题**，这是试炼之塔独有的终极题型：

| 融合类型 | 举例 | 涉及模块 |
|----------|------|----------|
| 分数×乘法 | 3/4 × 400 = ? | fraction + multiply |
| 单位+小数 | 2.5km = ?m | unit + decimal |
| 九九+分数 | 7×8的结果的1/4是多少? | xiaojiujiu + fraction |
| 大九九+单位 | 12×15分钟 = ?小时 | times + unit |
| 乘法+小数 | 25×0.04 = ? | multiply + decimal |
| 全模块融合 | 把3/8化成小数再×1000等于多少? | fraction + decimal + multiply |

融合题只在试炼之塔中出现，是区分普通战斗和终极挑战的核心差异。

### 5.4 试炼之塔独占怪物（全新主题：混沌）

设计 **20 只全新"混沌"主题怪物**，这些怪物不出现在其他任何模块中。

**关键区别**：塔怪物作为终极之路的怪物，在视觉和动画上必须与普通模块怪物有明显差异（详见 5.9 节）。

| 层区 | 怪物 | emoji | HP | 性格 | 特殊行为 | 独有攻击动画 |
|------|------|-------|----|------|----------|-------------|
| 入门 | 石砖精 | 🧱 | 3 | 防御型 | 护盾 | 砖块砸落 |
| 入门 | 火把蛾 | 🔥 | 3 | 胆小型 | 逃跑 | 火星飞溅 |
| 入门 | 蜘蛛丝 | 🕸️ | 4 | 狡猾型 | 闪避 | 蛛网缠绕 |
| 入门 | 迷路鬼 | 👻 | 4 | 阴险型 | 诅咒 | 灵魂吸取 |
| 入门 | 塔鼠 | 🐀 | 4 | 胆小型 | 分裂 | 群鼠冲锋 |
| 试炼 | 石像兵 | 🗿 | 5 | 防御型 | 护盾+防御 | 石拳猛击+地面震裂 |
| 试炼 | 暗影剑士 | ⚔️ | 6 | 暴力型 | 反击 | 十字斩+剑气残影 |
| 试炼 | 混沌法师 | 🧙‍♀️ | 6 | 阴险型 | 诅咒+召唤 | 暗紫魔法阵旋转轰击 |
| 试炼 | 镜像怪 | 🪞 | 5 | 狡猾型 | 分裂+闪避 | 镜面反射(玩家武器反弹) |
| 试炼 | 毒雾蛇 | 🐍 | 6 | 阴险型 | 自爆+诅咒 | 毒液喷射+持续毒雾 |
| 炼狱 | 烈焰卫士 | 🔥 | 7 | 暴力型 | 反击+愤怒 | 火焰旋风(全屏火粒子) |
| 炼狱 | 冰霜巫师 | ❄️ | 7 | 防御型 | 护盾+治愈 | 冰锥群(从上方落下) |
| 炼狱 | 雷电元素 | ⚡ | 8 | 暴力型 | 愤怒+反击 | 雷电链(连续3次闪电) |
| 炼狱 | 虚空行者 | 🌑 | 8 | 狡猾型 | 闪避+分裂+逃跑 | 空间撕裂(屏幕裂缝特效) |
| 炼狱 | 死亡骑士 | 💀 | 9 | 阴险型 | 诅咒+自爆+召唤 | 死神镰刀横扫(全屏暗影) |
| Boss | 看门石像 | 🗿 | 8 | 霸道型 | 防御+护盾+召唤 | 巨石崩塌+地震震动 |
| Boss | 混沌守卫 | ⚔️ | 12 | 霸道型 | 变身+全行为 | 混沌能量波(彩色冲击波) |
| Boss | 数学魔神·第一形态 | 😈 | 10 | 霸道型 | 召唤+防御+愤怒 | 暗黑火球(大型追踪弹) |
| Boss | 数学魔神·第二形态 | 👿 | 10 | 暴力型 | 反击+愤怒+诅咒 | 虚空裂缝(屏幕多处裂开) |
| Boss | 数学魔神·最终形态 | 🔮 | 10 | 阴险型 | 全行为解锁 | 全元素风暴(火+冰+雷+暗轮替) |

### 5.9 试炼之塔专属视觉体系

试炼之塔是终极挑战，其视觉风格必须与普通模块战斗有显著区分：

#### 5.9.1 舞台氛围差异

| 维度 | 普通模块战斗 | 试炼之塔 |
|------|-------------|----------|
| **背景** | 明亮主题色渐变（如小九九=蓝天草地） | 暗色系塔内场景：石墙+火把+阴影 |
| **地面** | 简单地平线 | 石砖地面纹理（CSS 棋盘格渐变） |
| **氛围粒子** | 无 | 浮动灰尘/萤火虫粒子（入门=萤火，试炼=火星，炼狱=暗红雾气） |
| **边框** | 无 | 石质边框 + 每层递进的裂缝效果 |
| **光照** | 均匀 | 火把摇曳光效（CSS 动画亮度波动 0.85~1.0） |

#### 5.9.2 塔怪物攻击动画（与普通怪物区别）

普通模块怪物攻击：怪物 emoji 冲刺 → 攻击 emoji 飞向主角 → 主角受击。流程简单。

塔怪物攻击升级为**多段攻击 + 环境联动**：

```
[普通怪物攻击]
  怪物冲刺 → 🔥 飞向主角 → 主角受击
  总时长: 0.5s

[塔·入门区怪物攻击]
  怪物蓄力 (0.15s) → 特色攻击emoji飞出 → 命中 + 小范围粒子 (0.2s)
  总时长: 0.55s（稍有差异感）

[塔·试炼区怪物攻击]
  怪物举起武器 (0.15s) → 攻击特效从怪物延伸到主角 (0.25s)
  → 命中 + 中范围粒子 + 屏幕微震 (0.15s)
  总时长: 0.55s

[塔·炼狱区怪物攻击]
  全屏微暗 (0.1s) → 怪物眼睛闪光 (0.1s)
  → 特色攻击动画全屏展开 (0.3s)
  → 命中 + 大范围粒子 + 屏幕强震 + 碎屑飞散 (0.2s)
  总时长: 0.7s

[塔·Boss 攻击]
  屏幕变暗 + 低沉轰鸣 (0.15s) → Boss 放大 1.2x + 蓄力光效 (0.2s)
  → 全屏特色攻击 (0.35s) → 强力命中 + 全屏闪白 + 强震 (0.2s)
  总时长: 0.9s
```

#### 5.9.3 塔怪物受击差异

| 怪物层级 | 普通受击 | 被终结技命中 |
|----------|----------|-------------|
| 入门怪 | 后退+闪白（同普通怪物） | 直接粉碎爆炸 |
| 试炼怪 | 后退+盔甲碎裂粒子 | 被击飞出屏幕边缘→爆炸 |
| 炼狱怪 | 仅微退+防御姿态（更扛打） | 先破防（护甲碎裂）→再粉碎 |
| Boss | 几乎不退+怒吼反应 | 分阶段：先破盾→再伤害→阶段切换 |

#### 5.9.4 塔怪物登场动画

| 怪物层级 | 登场方式 |
|----------|----------|
| 入门怪 | 从暗处走出 + 火把照亮 (0.5s) |
| 试炼怪 | 从地面裂缝爬出 + 碎石粒子 (0.6s) |
| 炼狱怪 | 从传送门中走出 + 暗能量波纹 (0.7s) |
| Boss 10层 | 石像从墙壁脱落 + 地震震动 + 碎石飞溅 (1.0s) |
| Boss 20层 | 混沌传送门撕裂打开 + 能量风暴 (1.2s) |
| Boss 30层 | 全屏闪白 → 暗 → 巨大暗影轮廓逐渐清晰 → 亮红眼 (1.5s) |

#### 5.9.5 层间过渡动画

每次击败怪物后进入下一层时的过渡：

```
[普通层过渡]
  屏幕向上滑动 (0.3s) → 新层数显示 "第 X 层" (0.5s) → 新怪物登场

[Boss层过渡]
  屏幕震动 + 铁门打开音效 (0.5s) → "BOSS" 大字闪现 (0.5s)
  → 背景渐变到Boss场景 (0.3s) → Boss 登场动画
```

### 5.5 试炼之塔掉率加成

| 内容 | 普通战斗 | 试炼之塔 |
|------|----------|----------|
| 卡牌基础掉率 | 10-20% | 25-40% |
| SR 权重 | 13% | 20% |
| SSR 权重 | 5% | 10% |
| UR 权重 | 2% | 5% |
| Boss 保底 | R级 | SR级 |
| 塔顶Boss | - | 必掉 SSR，10%概率 UR |

### 5.6 试炼之塔专属卡牌（10张）

| 稀有度 | 名称 | emoji | 获得方式 |
|--------|------|-------|----------|
| R | 塔之入场券 | 🎟️ | 首次进入试炼之塔 |
| R | 石像碎片 | 🗿 | 击败看门石像 |
| SR | 混沌之刃 | ⚔️ | 击败混沌守卫 |
| SR | 试炼之证 | 📜 | 通关第20层 |
| SR | 炼狱火花 | 🔥 | 通关第25层 |
| SSR | 混沌核心 | 💎 | 击败数学魔神 |
| SSR | 塔之征服者 | 🏆 | 无伤通关前10层 |
| SSR | 时间领主 | ⏰ | 30分钟内通关全塔 |
| UR | 数学之心·混沌 | 🌀 | 击败数学魔神最终形态 |
| UR | 全知之眼 | 👁️ | 集齐其他6颗数学之心后通关塔顶 |

### 5.7 试炼之塔 UI 设计

#### 入口位置
在主页菜单区域新增"试炼之塔"按钮（位于卡牌图鉴旁边）：
```
🛠️ 冒险工具
├── 📜 秘术卷轴
├── 📖 魔法残页
├── 🏅 成就殿堂
├── 🃏 卡牌图鉴
└── 🗼 试炼之塔  <- NEW（解锁条件：通关任意2个模块Normal难度）
```

#### 塔楼选层界面
```
┌──────────────────────────┐
│  🗼 试炼之塔               │
│                            │
│  当前进度: 第 14 层 / 30    │
│  ████████████░░░░░░░░░░░░  │
│                            │
│  📖 入门区 (1-9)    ✅完成  │
│  🗿 门卫Boss (10)   ✅完成  │
│  ⚔️ 试炼区 (11-19)  🔥进行中│
│  🛡️ 中Boss (20)     🔒未解锁│
│  🔥 炼狱区 (21-29)  🔒未解锁│
│  👑 塔顶 (30)       🔒未解锁│
│                            │
│  [继续挑战 第14层]           │
│  [从头开始]                  │
└──────────────────────────┘
```

### 5.8 试炼之塔规则

- **进度持久化**：塔层进度保存在 localStorage，中途退出不丢失
- **每层 = 1只怪物 + 3-5题**：节奏紧凑，不拖沓
- **HP 不回满**：层与层之间 HP 保持（通过答对回血），真正考验持久力
- **每 10 层一个回血点**：击败 Boss 后 HP 回满 + 获得 1 个道具
- **失败重置**：HP 归零则从当前区域起点重新开始（不是从第1层）
- **每日重置**：每天可以重新挑战一次完整塔（刷卡牌用）

---

## 六、每模块怪物扩充

### 6.1 扩充目标

每模块新增 8-10 只怪物，重点是：
- 补充更多具有 v15.0+ 行为字段的怪物
- 每个模块至少 3 只有新行为（反击/分裂/诅咒/护盾/变身）
- Boss 怪物至少新增 1 只"双阶段变身"Boss

### 6.2 扩充数量

| 模块 | 当前数量 | 新增 Easy | 新增 Normal | 新增 Hard | 新增 Boss | 总新增 |
|------|----------|-----------|-------------|-----------|-----------|--------|
| 小九九 | ~88 | 2 | 3 | 3 | 2 | 10 |
| 分数(山海经) | ~78 | 2 | 3 | 2 | 1 | 8 |
| 小数(西游记) | ~78 | 2 | 3 | 2 | 1 | 8 |
| 单位(封神) | ~78 | 2 | 3 | 2 | 1 | 8 |
| 乘法(聊斋) | ~50 | 3 | 3 | 3 | 1 | 10 |
| 大九九(HP) | ~78 | 2 | 3 | 2 | 1 | 8 |
| **合计** | ~450 | 13 | 18 | 14 | 7 | **52** |

加上试炼之塔 20 只 = **总计 72 只新怪物**

### 6.3 新怪物设计要求

- 必须有完整的 v15.0 台词字段（enterQuips, deathQuips, tauntQuips, fearQuips）
- 必须指定性格类型（personality 字段）
- 至少 40% 的新怪物有特殊行为组合
- 新 Boss 必须有变身机制（两阶段战斗）
- 中英文 story 不少于 80 字

---

## 七、新增成就（20个）

### 7.1 连击相关

| ID | 名称 | 图标 | 条件 |
|----|------|------|------|
| combo_awakened | 觉醒之力 | ✨ | 首次达到连击觉醒状态(3连) |
| combo_will | 战意昂扬 | ⚡ | 达到战意状态(5连)3次 |
| combo_godlike | 超神时刻 | 🌟 | 达到超神状态(10连) |
| combo_invincible | 无敌降临 | 👑 | 达到无敌状态(15连) |
| combo_unbroken | 不败战神 | 💪 | 单局连击30+不断 |
| combo_recover | 绝处逢生 | 🔄 | 使用追忆连击恢复连击3次 |

### 7.2 试炼之塔相关

| ID | 名称 | 图标 | 条件 |
|----|------|------|------|
| tower_enter | 踏入试炼 | 🗼 | 首次进入试炼之塔 |
| tower_10 | 突破门卫 | 🗿 | 通关第10层 |
| tower_20 | 击败守卫 | ⚔️ | 通关第20层 |
| tower_30 | 塔顶王者 | 👑 | 通关第30层 |
| tower_speed | 速通大师 | ⏱️ | 30分钟内通关全塔 |
| tower_flawless | 完美攀登 | 💎 | 通关前10层不受伤 |

### 7.3 新行为相关

| ID | 名称 | 图标 | 条件 |
|----|------|------|------|
| counter_survivor | 反击幸存者 | 🛡️ | 在怪物反击后存活并击败它 |
| split_cleaner | 分裂清道夫 | ✂️ | 消灭分裂怪物5次 |
| curse_breaker | 破咒者 | 🔓 | 在诅咒状态下连续答对3题 |
| shield_breaker | 破盾大师 | 💥 | 击破怪物护盾10次 |
| phase2_slayer | 真形终结 | ⚔️ | 击败变身Boss的第二形态 |
| behavior_master | 百战老将 | 🎖️ | 经历过所有14种怪物行为 |
| all_personality | 知己知彼 | 📖 | 击败过所有6种性格的怪物 |
| math_demon_slayer | 弑神者 | 🔮 | 击败数学魔神最终形态 |

---

## 八、卡牌系统 2.0 全面升级

### 8.1 当前卡牌现状与问题（v15.0）

当前卡牌系统：143 张卡（6 模块各 19 张 + 跨模块 10 张），5 级稀有度（N/R/SR/SSR/UR）。

```
当前卡牌正面：
  ┌─────────────────┐
  │  [稀有度标签]     │
  │                   │
  │      📖          │  <- 单个 emoji，太小太简单
  │                   │
  │   九九口诀         │  <- 名字
  │  "一一得一..."     │  <- flavor text
  │   九九乘法表的起源  │  <- 简短描述
  │   ✨效果: xxx      │  <- 有就显示
  │   xjj_n_01        │  <- 卡牌ID（太技术化）
  └─────────────────┘

当前卡牌图鉴：
  4列网格 → emoji + 名字 + 稀有度
  未收集的卡半透明
  点击显示简单弹窗
```

**核心问题**：
1. **不精美**：卡面只有 emoji + 文字，没有"卡牌"感，像数据列表不像收藏品
2. **信息贫乏**：点开详情只有 5 行信息，没有故事背景、获取途径、所属系列
3. **没有收藏机制**：不能按模块浏览、不能看收集进度、没有"集齐奖励"
4. **无法实体化**：当前设计完全无法打印成实体卡牌
5. **没有卡牌游戏感**：缺少分类（怪物卡/法术卡/知识卡）、没有攻防数值

### 8.2 卡牌视觉设计升级

#### 卡面布局重设计（参考宝可梦/游戏王/炉石传说）

```
新版卡牌正面（标准比例 5:7）：

┌──────────────────────────┐
│ [模块图标] 九九口诀 [稀有度]│ ← 顶部信息条（模块色背景）
│ ━━━━━━━━━━━━━━━━━━━━━━━━│
│                            │
│                            │
│         📖                │ ← 主视觉区（占卡面 40%）
│      (大号emoji)           │    带稀有度光效/粒子/动画
│                            │
│                            │
│ ━━━━━━━━━━━━━━━━━━━━━━━━│
│ ┌────────────────────┐    │
│ │ "一一得一，一二得二..." │  │ ← flavor text 区（斜体）
│ └────────────────────┘    │
│ ━━━━━━━━━━━━━━━━━━━━━━━━│
│ 九九乘法表的起源，            │ ← 描述/故事区
│ 传说最早由春秋时代发明...     │
│ ━━━━━━━━━━━━━━━━━━━━━━━━│
│ ⚔️ ATK: 3  🛡️ DEF: 2     │ ← 战斗数值（仅怪物/法术卡）
│ #001/019  小九九系列  [知识] │ ← 卡牌编号 + 系列 + 类型
└──────────────────────────┘

卡牌背面（统一设计，不可区分）：
┌──────────────────────────┐
│                            │
│        ✨ 数 学 ✨         │
│       ⚔️ 速算训练 ⚔️       │
│                            │
│     (数学几何纹理底纹)      │ ← 分形/黄金螺旋/棋盘几何
│     (品牌色渐变)            │
│                            │
│        v16.0               │
└──────────────────────────┘
```

#### 模块色彩系统（类似游戏王的卡框颜色）

| 模块 | 卡框主色 | 卡框渐变 | 代表元素 |
|------|----------|----------|----------|
| 小九九 | #E74C3C 红 | 红→橙 | 🔥 火焰 |
| 大九九 | #8E44AD 紫 | 紫→深紫 | ⚡ 雷电 |
| 乘法速记 | #F39C12 金 | 金→琥珀 | 💎 宝石 |
| 分数 | #3498DB 蓝 | 蓝→青 | 🌊 水流 |
| 小数 | #27AE60 绿 | 绿→翠 | 🌿 自然 |
| 单位 | #9B59B6 紫罗兰 | 紫→粉 | 🔮 魔法 |
| 跨模块 | 彩虹渐变 | 六色流动 | 🌈 融合 |
| 试炼之塔 | #2C3E50 暗灰 | 暗灰→暗红 | 🗼 混沌 |

#### 稀有度视觉效果（CSS 实现）

| 稀有度 | 卡框效果 | emoji 区效果 | 图鉴中效果 |
|--------|----------|-------------|-----------|
| **N 普通** | 纯色实线边框 | 无特效 | 正常显示 |
| **R 稀有** | 模块色边框 + 微光 | 柔和脉冲光晕 | 边框微光 |
| **SR 史诗** | 渐变旋转边框（CSS conic-gradient 旋转动画） | 粒子环绕 + 对角线光带扫过 | 闪光动画 |
| **SSR 传说** | 金色呼吸光效边框 + 金色内发光 | 动态光环（火焰/雷电/水波等模块主题） | 金色脉冲 + 微震 |
| **UR 神话** | 彩虹棱镜边框（六色循环流动） | 全卡面动态背景 + 主题粒子盛宴 | 持续彩虹流光 + 悬浮效果 |

关键参考：[Pokemon Cards CSS](https://github.com/simeydotme/pokemon-cards-css) 开源项目提供了全套全息光效、棱镜边框、3D 倾斜效果的 CSS 实现，无需 JS。

### 8.3 卡牌分类系统（5 类，对应实体卡牌游戏）

将 143 张现有卡牌 + 10 张塔卡牌重新分类为 5 种卡牌类型：

| 类型 | 对应稀有度 | 卡框标识 | 数量 | 类比 |
|------|-----------|----------|------|------|
| **知识卡** | 主要 N 级 | 📖 书本图标 | ~52 张 | 游戏王·通常怪兽 |
| **怪物卡** | 主要 R 级 | 👾 怪物图标 | ~32 张 | 宝可梦·基本宝可梦 |
| **法术卡** | 主要 SR 级 | ✨ 星星图标 | ~20 张 | 游戏王·魔法卡 |
| **传说卡** | SSR 级 | 👑 皇冠图标 | ~13 张 | 宝可梦·V/VMAX |
| **神话卡** | UR 级 | 💎 宝石图标 | ~8 张 | 宝可梦·Crown Rare |

#### 各类卡牌设计规范

**知识卡（N）— "数学口诀的基石"**
```
特点：
- 教育属性最强，每张卡正面有完整的数学知识点
- 无战斗数值（ATK/DEF 区域改为"知识点"区域）
- 大字号展示核心公式或规律
- 卡面设计简洁清爽，突出教学内容
- 例："九的规律" → 正面大字显示 "9×N 的十位和个位相加=9"

实体游戏用途：作为"基础牌"，每回合可打出 1 张知识卡获得 1 点能量
```

**怪物卡（R）— "你征服过的对手"**
```
特点：
- 每张对应一个战斗中的怪物
- 有 ATK（攻击力）和 DEF（防御力）数值
- 有"属性"标签（火/冰/毒/仙/暗等，来自怪物 type）
- 卡面展示怪物 emoji + 怪物台词作为 flavor
- 有怪物背景故事（来自 story 字段或新增）
- 例："噗噗鬼" → ATK:2 DEF:1 暗属性 "噗噗~别怕我~"

实体游戏用途：作为"战斗牌"，打出后可攻击对手
```

**法术卡（SR）— "强大的数学武器"**
```
特点：
- 每张有明确的游戏内效果（weaponBoost, comboTrigger 等）
- 效果文字突出显示在卡面中央
- 卡面有魔法/技能主题的视觉设计
- 有使用条件描述
- 例："火球术精通" → "施放时：火属性武器伤害+1" + 🔥 大号 emoji

实体游戏用途：作为"法术牌"，单次使用后弃置，产生特殊效果
```

**传说卡（SSR）— "Boss 之魂"**
```
特点：
- 对应 Boss 怪物或重大成就
- 高 ATK/DEF 数值
- 有多段效果描述
- 卡面有金色装饰 + 扩展画面
- 完整的背景故事（不少于 80 字）
- 例："九九魔王印" → ATK:5 DEF:4 "击败九九终极守护者获得的勋章"

实体游戏用途：强力战斗牌，每局只能带 2 张传说卡
```

**神话卡（UR）— "数学之心"**
```
特点：
- 每模块 1 张"数学之心"+ 试炼之塔特殊卡
- 卡面全幅动态效果（彩虹流光）
- 史诗级背景故事（不少于 120 字）
- 展示效果最华丽
- 例："数学之心·乘法" → "蕴含着乘法终极奥义的结晶，传说集齐六颗数学之心..."

实体游戏用途：终极牌，独一无二的强力效果
```

### 8.4 卡牌详情页重设计

当前点击卡牌只显示 5 行简单信息。参考宝可梦/炉石的卡牌详情页，重设计为沉浸式全屏详情：

```
卡牌详情页（全屏弹窗）：

┌────────────────────────────────────┐
│  ← 返回           🃏 #001/019     │ ← 顶栏：返回 + 编号
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━│
│                                     │
│         ┌──────────────┐           │
│         │              │           │
│         │    📖        │           │ ← 卡牌实物预览（带稀有度光效）
│         │  (大号卡面)   │           │    UR 可互动：点击触发特殊动画
│         │              │           │
│         └──────────────┘           │
│                                     │
│  九九口诀              N · 知识卡   │ ← 名称 + 稀有度 + 类型
│  ─── 小九九系列 ───                 │ ← 所属模块
│                                     │
│ ┌──────────────────────────────┐   │
│ │ 📜 背景故事                    │   │ ← 故事区（核心新增）
│ │                                │   │
│ │ 九九乘法表最早记载于春秋时代    │   │
│ │ 的《管子》一书中。古人发现       │   │
│ │ 数字之间的乘法关系可以用口诀    │   │
│ │ 来记忆，这个智慧传承了两千年... │   │
│ └──────────────────────────────┘   │
│                                     │
│ ┌──────────────────────────────┐   │
│ │ 💡 数学知识                    │   │ ← 知识点区（知识卡专有）
│ │ 9×N 的十位和个位相加永远等于9  │   │
│ │ 例: 9×7=63, 6+3=9             │   │
│ └──────────────────────────────┘   │
│                                     │
│ ┌──────────────────────────────┐   │
│ │ 🎯 获取方式                    │   │ ← 告诉玩家怎么得到这张卡
│ │ 在小九九模块战斗中击败任意怪物  │   │
│ │ 概率掉落                       │   │
│ └──────────────────────────────┘   │
│                                     │
│ ┌──────────────────────────────┐   │
│ │ 📦 所属系列                    │   │ ← 系列收集进度
│ │ 小九九系列 ████████░░ 14/19   │   │
│ │ 集齐奖励: 🏅 九九大师徽章      │   │
│ └──────────────────────────────┘   │
│                                     │
│ ── 同系列卡牌 ──                   │ ← 关联卡牌横向滚动
│ [📖][📖][👻][🔥][💎]...          │
│                                     │
│        📅 2026-02-08 获得          │ ← 收集日期
└────────────────────────────────────┘
```

#### 怪物卡详情页额外内容

```
│ ┌──────────────────────────────┐   │
│ │ ⚔️ 战斗属性                    │   │
│ │ ATK 攻击力: ⭐⭐⭐ (3)          │   │
│ │ DEF 防御力: ⭐⭐ (2)            │   │
│ │ 属性: 🔥 火                    │   │
│ │ 性格: 暴力型                   │   │
│ └──────────────────────────────┘   │
│                                     │
│ ┌──────────────────────────────┐   │
│ │ 💬 怪物台词                    │   │
│ │ 登场: "吾乃九九之主！"          │   │
│ │ 嘲讽: "这都不会？哈哈哈！"     │   │
│ │ 恐惧: "不...不要过来..."       │   │
│ │ 死亡: "我会回来的..."          │   │
│ └──────────────────────────────┘   │
```

#### 法术卡详情页额外内容

```
│ ┌──────────────────────────────┐   │
│ │ ✨ 卡牌效果                    │   │
│ │ 🔥 火球术伤害 +1               │   │
│ │ 触发条件: 使用火属性武器攻击时  │   │
│ │ 效果持续: 整场战斗              │   │
│ └──────────────────────────────┘   │
```

### 8.5 卡牌图鉴系统升级

#### 多维筛选（参考炉石传说收藏管理器）

当前只有按稀有度筛选。升级为三维组合筛选：

```
筛选栏设计：

第一行（模块筛选）：
[全部] [🔥小九九] [⚡大九九] [💎乘法] [🌊分数] [🌿小数] [🔮单位] [🗼塔]

第二行（稀有度筛选）：
[全部] [N] [R] [SR] [SSR] [UR]

第三行（状态筛选）：
[全部] [✅已收集] [❓未收集] [🆕新获得]
```

三个维度可组合使用，如"小九九模块 + SR + 未收集"。

#### 模块系列页（参考宝可梦卡包系列）

每个模块有独立的"系列收集页"，带主题色背景：

```
┌──────────────────────────────────┐
│  🔥 小九九系列                     │ ← 模块主题色页头
│  收集进度: 14/19                   │
│  ████████████████░░░░ 74%         │
│                                    │
│  ── N 知识卡 (6/8) ──            │ ← 按稀有度分组
│  [📖✅][📖✅][📖✅][📖✅]        │
│  [📖✅][📖✅][📖❓][📖❓]        │
│                                    │
│  ── R 怪物卡 (4/5) ──            │
│  [👻✅][🐉✅][🔥✅][💀✅]        │
│  [🧙❓]                           │
│                                    │
│  ── SR 法术卡 (3/3) ✅完成 ──     │ ← 完成标记
│  [🔥✅][⚡✅][💫✅]                │
│                                    │
│  ── SSR 传说卡 (1/2) ──          │
│  [👹✅][💫❓]                     │
│                                    │
│  ── UR 神话卡 (0/1) ──           │
│  [💎❓]                           │
│                                    │
│  ── 集齐奖励 ──                   │ ← 系列完成奖励
│  🔒 集齐全部19张解锁:             │
│     🏅 "九九大师"成就              │
│     🎨 专属卡牌边框               │
└──────────────────────────────────┘
```

#### "新卡"标识

所有刚获得还未在图鉴中查看过的卡牌，在网格中显示 "NEW" 角标（红色圆点），点击详情后消失。参考宝可梦 TCG Pocket。

#### 重复卡牌处理

当前重复卡直接跳过。升级为"数学水晶"货币系统：

| 重复卡稀有度 | 转化水晶数 |
|-------------|-----------|
| N 重复 | 1 💎 |
| R 重复 | 3 💎 |
| SR 重复 | 10 💎 |
| SSR 重复 | 30 💎 |
| UR 重复 | 100 💎 |

水晶用途：
- 50💎 购买随机卡包（保底 R）
- 200💎 购买指定模块卡包
- 100💎 购买卡牌背面皮肤
- 500💎 购买指定 SR 卡

### 8.6 卡牌数据模型升级

当前每张卡只有 7 个字段。升级为完整的数据模型：

```javascript
// 当前字段（保留）
{
    id: 'xjj_n_01',
    name: '九九口诀',
    rarity: 'N',
    module: 'xiaojiujiu',
    emoji: '📖',
    flavor: '一一得一，一二得二...',
    desc: '九九乘法表的起源',
    effect: null,

    // ===== v16.0 新增字段 =====
    category: 'knowledge',        // 'knowledge'|'monster'|'spell'|'legend'|'mythic'
    story: '九九乘法表最早记载于春秋时代的《管子》一书中...',  // 背景故事（≥50字）
    mathTip: '9×N 的十位和个位相加永远等于9',               // 数学知识点（知识卡专有）
    obtainMethod: '在小九九模块战斗中击败任意怪物概率掉落',    // 获取方式描述
    atk: null,                   // 攻击力 1-6（怪物卡/传说卡/神话卡有值）
    def: null,                   // 防御力 1-6（同上）
    element: null,               // 属性 'fire'|'ice'|'poison'|'dark'|'holy'|'thunder'
    relatedCards: ['xjj_n_02'],  // 关联卡牌ID数组
    sortOrder: 1,                // 模块内排序号
    setBonus: 'xjj_master',     // 集齐系列的奖励ID
    // 怪物卡专有
    monsterRef: 'pupu_ghost',   // 关联的怪物ID
    quoteEnter: '吾乃九九之主！',  // 登场台词
    quoteTaunt: '这都不会？',      // 嘲讽台词
    quoteDeath: '我会回来的...',   // 死亡台词
    // 法术卡专有
    effectCondition: '使用火属性武器攻击时',  // 效果触发条件
    effectDuration: 'battle',   // 'once'|'battle'|'permanent'
    // 实体卡牌专有
    printId: 'MST-XJJ-001',    // 印刷编号
    artist: '数学速算训练',       // 作者/版权
}
```

注意：N 级知识卡可以用模板批量填充 `story` 和 `mathTip`，R+ 卡牌需要手写故事。

### 8.7 实体卡牌游戏设计

#### 印刷规格

| 规格 | 数值 |
|------|------|
| 卡牌尺寸 | 63.5mm × 88.9mm（标准 TCG 尺寸） |
| 宽高比 | 5:7 |
| 印刷分辨率 | 300 DPI |
| 像素尺寸 | 750 × 1050 px |
| 出血区域 | 每边 3mm |
| 安全区域 | 每边距裁切线 3mm 以内不放关键内容 |
| 圆角半径 | 3.5mm |
| 纸张 | 300gsm 蓝芯卡纸（防透光） |

#### 实体卡牌游戏规则："数学对决"

**适合人数**：2 人
**适合年龄**：7-12 岁
**游戏时长**：10-15 分钟

**组牌规则**：
- 每人组建 20 张卡的牌组
- 必须包含：≥10 张知识卡、≤5 张怪物卡、≤5 张法术/传说卡
- 传说卡（SSR）每种最多带 2 张
- 神话卡（UR）每种最多带 1 张

**游戏流程**：

```
准备：
  - 双方各 20 HP
  - 抽 5 张手牌
  - 准备"题库牌组"（单独一叠印好的数学题卡）

每回合：
  1. 抽牌阶段：抽 1 张
  2. 挑战阶段：翻开题库牌顶的数学题，双方同时解答
  3. 结算阶段：
     - 答对的一方可以打出手牌：
       · 打出知识卡 → 获得 1 能量
       · 打出怪物卡（需 N 能量）→ 对对手造成 ATK 点伤害
       · 打出法术卡 → 触发特殊效果
     - 答错或慢的一方：不能出牌，且受到 1 点基础伤害
  4. 弃牌阶段：手牌上限 7 张

胜负条件：
  - 对手 HP 降到 0 → 胜利
  - 题库牌组用尽 → HP 多的一方胜利
```

**题库牌设计**（单独印刷，约 60 张）：

| 难度 | 数量 | 颜色 | 题型 |
|------|------|------|------|
| Easy | 20 张 | 绿色 | 小九九基础题 |
| Normal | 25 张 | 蓝色 | 分数/小数/单位混合题 |
| Hard | 15 张 | 红色 | 大九九/乘法速记/融合题 |

**实体卡牌套装内容**：

```
一套"数学速算卡牌"包含：
  - 153 张角色卡（143 原有 + 10 塔专属）
  - 60 张题库卡
  - 2 张 HP 追踪卡（正面 1-20 刻度，用夹子标记）
  - 1 张快速规则卡
  - 1 张完整规则说明书
```

### 8.8 卡牌相关新增内容统计

| 项目 | v15.0 | v16.0 | 变化 |
|------|-------|-------|------|
| 卡牌总数 | 143 | 153 (+10塔卡) | +10 |
| 卡牌字段数 | 7-8 | 18-22 | +11~14 |
| 卡牌类型 | 1 种 | 5 种 | +4 |
| 详情信息项 | 5 项 | 12+ 项 | +7 |
| 筛选维度 | 1 (稀有度) | 3 (模块+稀有度+状态) | +2 |
| 系列收集页 | 0 | 8 (6模块+跨模块+塔) | +8 |
| 集齐奖励 | 0 | 8 系列奖励 | +8 |
| 重复卡处理 | 跳过 | 水晶货币 | 新机制 |
| 实体化支持 | 无 | 完整印刷规格+游戏规则 | 新系统 |

### 8.9 卡牌系统技术要点

- 新增 `story`、`mathTip`、`obtainMethod` 等字段会显著增加 `card-data.js` 文件体积（预估从 ~800 行增至 ~2000 行）
- 卡牌详情页为全新 HTML 结构，在 `card-system.js` 中重写 `showCardDetail()`
- 稀有度 CSS 光效参考 [pokemon-cards-css](https://github.com/simeydotme/pokemon-cards-css)，纯 CSS 实现（conic-gradient + animation + mix-blend-mode），不加 JS 负担
- "数学水晶"货币存储在 localStorage（`mathCrystal_userId`）
- 收集日期记录：卡牌集合从 `['cardId']` 改为 `[{id: 'cardId', obtainedAt: timestamp, viewed: boolean}]`
- 实体卡牌印刷模板：在 Web 端提供"导出打印版 PDF"功能（后续版本考虑，v16.0 先做好数据和视觉）

---

## 九、音效系统全面升级

### 8.0 当前音效现状（v15.0，共 22 种）

| 类别 | 音效 | 实现方式 | 问题 |
|------|------|----------|------|
| 基础反馈 | correct, wrong | 单音升/降 | 过于简单，每次一样 |
| 连击 | streak | 3音和弦 | 不管连击多少都一个声音 |
| 成就 | achievement, complete | 4-7音旋律 | 还行 |
| 战斗 | attack, hit, monsterAttack, defeat, gameOver | 方波/锯齿波 | **attack 永远同一个音，不管是普通攻击还是终结技** |
| 行为 | dodge, defend, enrage, summon | 基础音效 | 太简陋，缺少 5 种新行为音效 |
| 卡牌 | cardDrop, cardFlip, bossEntrance | 基础音效 | 还行 |
| UI | countdown, click | 短音 | 不需改动 |

**核心问题**：
- 攻击音效单调：不管连击 1 还是连击 15，听到的都是同一个 `attack` 音
- 缺少节奏感：没有蓄力音、释放音、命中反馈的层次
- 缺少环境音：试炼之塔没有氛围音效
- 怪物攻击千篇一律：所有怪物攻击都是同一个 `monsterAttack` 音

### 8.1 攻击音效分级（配合 5 种攻击模式）

| 连击阶段 | 音效名 | 设计 | 特点 |
|----------|--------|------|------|
| **普通(0-2)** | `attackNormal` | 单音：锯齿波 800→200Hz 0.2s | 与现有 attack 类似，清脆干净 |
| **觉醒(3-4)** | `attackDouble` | 双音连击：第一击 800→400Hz + 0.08s 间隔 + 第二击 600→300Hz | 听得出两下，节奏明快 |
| **战意(5-9)** | `attackTriple` | 三连音+尾刀重击：3个快速短音(0.08s间隔) + 低沉重击音(方波 200→50Hz) | 前快后重，有节奏高潮 |
| **超神(10-14)** | `attackCharged` | 蓄力+释放两段：蓄力(正弦波 200→800Hz 上升 0.3s) → 释放爆发(锯齿+方波叠加 1000→100Hz 0.3s) | 先安静蓄力再猛烈释放 |
| **无敌(15+)** | `attackUltimate` | 完整音乐片段：3音和弦铺底 + 上升音阶(0.4s) → 爆发重击(双振荡器叠加 0.3s) → 余韵回响(正弦波衰减 0.3s) | 史诗感，独一无二 |

#### 攻击命中音效分级

| 连击阶段 | 音效名 | 设计 |
|----------|--------|------|
| 普通命中 | `hitNormal` | 现有 hit 音（方波 150→50Hz） |
| 觉醒命中 | `hitDouble` | 双重打击音（两个错开 0.05s 的打击音） |
| 战意命中 | `hitTriple` | 三连打击 + 尾刀重击（低频爆破） |
| 超神命中 | `hitCharged` | 爆炸音（双振荡器 + 白噪声模拟 0.3s） |
| 无敌命中 | `hitUltimate` | 全频爆裂 + 余韵（三振荡器 + 反响衰减 0.5s） |

### 8.2 连击状态切换音效

| 时机 | 音效名 | 设计 |
|------|--------|------|
| 进入觉醒(combo 3) | `comboAwaken` | 2 音上升 + 微弱火焰嗡鸣（锯齿波低频持续 0.1s） |
| 进入战意(combo 5) | `comboWill` | 3 音上升和弦 + 电弧嗡鸣（方波高频颤音 0.15s） |
| 进入超神(combo 10) | `comboGodlike` | 4 音史诗和弦 + 能量共振（正弦叠加锯齿 持续 0.3s） |
| 进入无敌(combo 15) | `comboInvincible` | 完整 5 音升阶旋律 + 持续低频共振 + 高频闪烁（总计 0.5s） |
| 连击断裂 | `comboBreak` | 玻璃碎裂音：高频正弦波快速下降(2000→200Hz 0.15s) + 碎裂散音(3个随机频率短音散开 0.2s) |
| 连击护盾消耗 | `comboShieldBreak` | 盾碎音：金属撞击(三角波 1500→500Hz) + 碎裂(方波随机 0.2s) |
| 追忆连击恢复 | `comboRecover` | 回旋上升音：正弦波 300→600→400→800Hz 波浪式上升 0.3s |

### 8.3 怪物行为音效（v15.0 现有 + v16.0 新增）

#### 现有行为音效升级

| 行为 | v15.0 音效 | v16.0 升级 |
|------|-----------|------------|
| **闪避** dodge | 正弦波 whoosh 0.3s | + 嘲笑音（高频跳动 3 短音 0.15s）模拟"嘿嘿" |
| **防御** defend | 三角波金属音 0.25s | + 连续 2-3 次叮叮声（每次武器攻击被弹开一次） |
| **愤怒** enrage | 锯齿波上升 0.4s | + 持续低频轰鸣背景（方波 50-80Hz 维持 2s，在愤怒期间循环） |
| **召唤** summon | 5 音上升 0.15s/音 | + 地面隆隆声（低频正弦波 40-60Hz 0.5s）+ 小怪出现尖叫 |
| **自爆** selfDestruct | 无独立音效 | 新增：倒计时滴答(3 次高频短音 0.8s) → 膨胀嗡鸣(上升 0.3s) → 爆炸(全频爆破 0.4s) |
| **治愈** heal | 无独立音效 | 新增：叮铃上升旋律(4 音正弦 0.4s) + 柔和回响 |
| **逃跑** escape | 无独立音效 | 新增：烟雾噗声(噪声 0.1s) + 脚步声远去(频率递减 3 短音 0.3s) |
| **嘲讽** taunt | 无独立音效 | 新增：挑衅鼓点(方波 3 连击 0.2s) + 怒气嗡声 |
| **恐惧** fear | 无独立音效 | 新增：颤抖音(快速振颤正弦波 0.3s) + 哭泣下降(2 音 0.2s) |

#### v16.0 新行为音效

| 行为 | 音效名 | 设计 |
|------|--------|------|
| **反击** | `counter` | 金属碰撞(三角波 1200Hz 0.05s) → 反弹嗖声(正弦波 400→1200Hz 0.15s) → 命中主角(低频方波 0.1s) |
| **分裂** | `split` | 撕裂音(锯齿波 800→400Hz 0.15s) → 双份弹出音(两个上升正弦波错开 0.05s) |
| **诅咒** | `curse` | 阴森低语(低频锯齿 60-100Hz 波动 0.4s) + 魔法扭曲(正弦波频率随机抖动 0.3s) |
| **护盾** | `shield` | 能量凝聚(正弦波 200→600Hz 上升 0.2s) → 护盾激活嗡(持续三角波 500Hz 0.3s + 衰减) |
| **变身** | `transform` | 能量风暴(3 振荡器叠加 随机频率 0.3s) → 闪白寂静(0.1s 静音) → 重生爆发(全频上升 0.3s) |

### 8.4 怪物攻击音效分化

当前所有怪物攻击都用同一个 `monsterAttack` 音。v16.0 按怪物性格分化攻击音效：

| 怪物性格 | 音效名 | 设计 |
|----------|--------|------|
| **暴力型** | `monsterAttackViolent` | 重击：低频方波猛砸(100→30Hz 0.2s) + 碎裂余音 |
| **狡猾型** | `monsterAttackCunning` | 快速突袭：高频锯齿波快闪(800→1200→200Hz 0.15s) |
| **防御型** | `monsterAttackDefensive` | 沉稳一击：中频三角波(400→200Hz 0.25s) + 沉闷回响 |
| **阴险型** | `monsterAttackSinister` | 暗影侵蚀：低频叠加噪声(80→120Hz 锯齿波 + 随机频率颤动 0.3s) |
| **胆小型** | `monsterAttackTimid` | 试探攻击：高频短音(1000Hz 0.05s) 弱气 |
| **霸道型**(Boss) | `monsterAttackBoss` | 霸气全屏：双振荡器低频轰鸣(60+80Hz 0.15s) → 猛烈释放(锯齿+方波 300→50Hz 0.3s) |

### 8.5 试炼之塔专属音效

| 音效名 | 触发时机 | 设计 |
|--------|----------|------|
| `towerEnter` | 进入试炼之塔 | 石门开启(低频隆隆声 0.8s) + 回声(递减 0.4s) |
| `towerFloorUp` | 通关一层上升 | 阶梯上升 3 音(正弦 C-E-G 各 0.1s) |
| `towerBossGate` | Boss 层开门 | 铁链拉动(锯齿波震颤 0.4s) → 铁门开启(低频碰撞 0.3s) → 回响 |
| `towerAmbientIntro` | 入门区背景 | 微弱风声(噪声波 极低音量循环) + 远处水滴(随机间隔高频短音) |
| `towerAmbientTrial` | 试炼区背景 | 火把噼啪(随机短噪声) + 低沉嗡鸣(正弦 40Hz 极低音量) |
| `towerAmbientInferno` | 炼狱区背景 | 持续低频轰鸣(方波 30-50Hz 波动) + 远处尖叫(高频衰减 随机触发) |
| `towerBossTheme` | Boss 战斗 | 紧张鼓点循环：方波节拍(120BPM) + 低频 bassline |
| `towerVictory` | 通关塔顶 | 完整胜利旋律(8 音史诗和弦序列 2s) + 钟声回响 |
| `towerDefeat` | 塔内失败 | 石碎崩塌音(低频下降 0.5s) + 回响消失 |

### 8.6 音效实现技术要点

```
所有音效继续使用 Web Audio API（无外部音频文件），保持 PWA 轻量：

- 基础：OscillatorNode (sine/square/sawtooth/triangle)
- 新增：使用 AudioBuffer + 白噪声 模拟打击/爆炸音
- 新增：使用 BiquadFilterNode 做低通/高通滤波，增加音色变化
- 新增：使用 ConvolverNode 简易混响（塔内回声效果）
- 新增：背景音循环：用 setInterval 触发随机环境音（塔氛围）

音量层级：
  - 主攻击音效: gain 0.2-0.3
  - 行为音效: gain 0.15-0.25
  - 环境音: gain 0.03-0.08（不干扰主音效）
  - 终结技: gain 0.3-0.4（最大，突出史诗感）

性能约束：
  - 同时活跃的 OscillatorNode 不超过 6 个
  - 背景环境音在离开塔页面后立即停止
  - 所有音效总时长不超过 2s（避免堆积）
```

### 8.7 音效总量统计

| 类别 | v15.0 | v16.0 新增 | v16.0 总计 |
|------|-------|-----------|-----------|
| 攻击音效 | 1 (attack) | +4 阶段攻击 +5 阶段命中 | 11 |
| 连击音效 | 1 (streak) | +4 阶段切换 +3 保护相关 | 8 |
| 怪物攻击 | 1 (monsterAttack) | +5 性格分化 | 7 |
| 行为音效 | 4 (dodge/defend/enrage/summon) | +5 新行为 +5 旧行为补全 | 14 |
| 塔专属 | 0 | +9 | 9 |
| 基础/UI | 7 | 不变 | 7 |
| 卡牌 | 3 | 不变 | 3 |
| **合计** | **~22** | **~+37** | **~59** |

---

## 十、技术方案

### 8.1 v15.0 蜂群开发经验总结

在 v15.0 的开发中积累了以下关键经验：

| 经验 | 说明 | v16.0 应用 |
|------|------|------------|
| **新文件优于改文件** | 创建 card-data.js/battle-arena.js/monster-behavior.js/card-system.js 4个新文件，比修改 battle-combat.js 风险低很多 | v16.0 继续新建文件承载新功能 |
| **并行Agent开发** | 4个新文件可以同时由4个Agent并行创建，互不干扰 | v16.0 的新文件设计要利于并行 |
| **Hook式集成** | battle-combat.js 只在关键节点插入 1-2 行 hook 调用，不重写函数 | v16.0 的连击系统和新行为同样用 hook 方式 |
| **回调驱动动画** | 所有动画用 callback(cb) 模式，可靠的链式调用 | v16.0 多段攻击动画必须用 callback 链 |
| **数据与逻辑分离** | card-data.js 纯数据，card-system.js 纯逻辑 | v16.0 塔数据和塔逻辑分开文件 |
| **DOM ID保持不变** | v15.0 保留了所有现有 DOM ID，只增不改 | v16.0 同样不改现有 ID |
| **CSS 只用 transform/opacity** | iPad PWA 60fps 的关键 | v16.0 多段攻击动画同样遵守 |
| **粒子上限50** | 防止 iPad 卡顿 | v16.0 终结技粒子也不超限 |

### 8.2 新增文件

| 文件 | 行数估算 | 内容 |
|------|----------|------|
| `js/hero-system.js` | ~400行 | 主角多层渲染 + 连击阶段管理 + 攻击动画序列 |
| `js/combo-engine.js` | ~300行 | 连击系统2.0逻辑 + 连击保护 + 追忆连击 |
| `js/behavior-v2.js` | ~350行 | 5种新行为执行器 + 性格系统 + 行为组合 |
| `js/tower-data.js` | ~500行 | 试炼之塔层级配置 + 20只混沌怪物数据 + 10张专属卡牌 |
| `js/tower-mode.js` | ~450行 | 试炼之塔战斗逻辑 + 进度持久化 + UI渲染 |

### 8.3 修改的现有文件

| 文件 | 改动程度 | 改动内容 |
|------|----------|----------|
| `index.html` | **中改** | 新增主角多层DOM、试炼之塔页面HTML、试炼之塔选层HTML |
| `css/style.css` | **大改** | ~500行新CSS：主角多层样式、多段攻击动画、新行为特效、塔UI |
| `battle-combat.js` | **中改** | hook 插入：连击阶段切换 + 新行为触发 + 多段攻击调用 |
| `battle-arena.js` | **中改** | 主角区域DOM构建适配多层、新动画方法 |
| `monster-behavior.js` | **中改** | 新增性格系统 + 5种新行为条件检查 |
| `effects.js` | **大改** | ~37个新音效(攻击分级+连击切换+行为补全+怪物分化+塔专属) + ~5个新粒子效果 |
| `card-data.js` | **大改** | 全部143+10张卡牌新增story/mathTip/obtainMethod/atk/def/category等字段(~800→~2000行) |
| `card-system.js` | **大改** | 重写showCardDetail()为沉浸式全屏、新增多维筛选、系列页、水晶系统、新卡标识 |
| `data.js` | **小改** | 新增20个成就定义 |
| `core.js` | **小改** | App.battle 新增连击阶段字段、App.tower 状态 |
| `app.js` | **小改** | 试炼之塔页面事件绑定 |
| `ui-pages.js` | **小改** | 主页新增试炼之塔入口 + 解锁判断 |
| 6个monster文件 | **中改** | 每个文件新增 8-10 只怪物 |

### 8.4 脚本加载顺序

```
data.js → 5个monster文件 → core.js → effects.js → practice.js → daily.js →
ui-pages.js → battle-data.js → card-data.js → tower-data.js(新) →
battle-arena.js → hero-system.js(新) → combo-engine.js(新) →
monster-behavior.js → behavior-v2.js(新) → card-system.js →
battle-collection.js → tower-mode.js(新) → battle-combat.js → app.js
```

### 8.5 蜂群分工建议

| 蜂群(Agent) | 文件 | 任务 | 依赖 |
|-------------|------|------|------|
| **Agent-A** | hero-system.js + CSS | 主角多层系统 + 全部攻击动画 | 无 |
| **Agent-B** | combo-engine.js | 连击2.0逻辑 | 无 |
| **Agent-C** | behavior-v2.js | 5种新行为 + 性格系统 | 无 |
| **Agent-D** | tower-data.js | 塔数据 + 混沌怪物 + 专属卡牌 | 无 |
| **Agent-E** | tower-mode.js + HTML | 塔战斗逻辑 + UI | tower-data.js |
| **Agent-F** | 6个monster文件 | 52只新怪物 | 无 |
| **Agent-G** | effects.js + style.css | 37个新音效(含攻击分级/连击/行为/怪物性格/塔专属) + 新粒子 + 新CSS动画 | 无 |
| **Agent-H** | card-data.js 大改 | 153张卡牌扩充字段(story/mathTip/atk/def/category等) | 无 |
| **Agent-I** | card-system.js + CSS | 卡牌详情页重写+多维筛选+系列页+水晶系统+稀有度CSS光效 | 无 |
| **主线程** | battle-combat.js hook集成 + index.html | 在所有Agent完成后做集成 | 全部 |

**并行度**：Agent A/B/C/D/F/G/H/I 可完全并行（8路），Agent E 在 D 完成后启动

---

## 十一、开发与测试计划

### 11.1 开发阶段

| 阶段 | 内容 | 验收标准 |
|------|------|----------|
| **Phase 1** | hero-system.js + combo-engine.js + CSS | 5种攻击模式在不同连击阶段正确切换 |
| **Phase 2** | effects.js 音效大改 | 37个新音效：攻击分级+连击切换+行为补全+怪物性格+塔专属 |
| **Phase 3** | behavior-v2.js + monster-behavior.js升级 | 14种行为均可触发，性格系统生效，每种行为有对应音效 |
| **Phase 4** | tower-data.js + tower-mode.js + HTML | 试炼之塔30层可通关，进度保存，融合题正常 |
| **Phase 5** | card-data.js 扩充 + card-system.js 重写 | 153张卡牌完整字段、详情页沉浸式、多维筛选、水晶系统 |
| **Phase 6** | 72只新怪物 + 10张新卡牌 + 20个新成就 | 数据完整无语法错误 |
| **Phase 7** | battle-combat.js 集成 + 全量联调 | 所有模块战斗正常 + 试炼之塔正常 + 音画同步 |
| **Phase 8** | 性能优化 + 回归测试 | iPad PWA 60fps，非战斗功能不受影响，音效不堆积 |

### 11.2 自测清单

#### 第一轮：主角系统
- [ ] 连击0-2：普通攻击，单发武器飞行
- [ ] 连击3-4：觉醒状态，两连击动画
- [ ] 连击5-9：战意状态，三连斩+尾刀
- [ ] 连击10-14：超神状态，蓄力斩特写
- [ ] 连击15+：无敌状态，终结技全屏演出
- [ ] 连击断裂：火焰熄灭+碎裂动画
- [ ] 连击护盾：10连后第一次答错不清零
- [ ] 追忆连击：答错后立即答对恢复50%

#### 第二轮：怪物行为
- [ ] 反击：Boss格挡+反弹伤害
- [ ] 分裂：死亡后分裂为小号副本
- [ ] 诅咒：选项增加到5个
- [ ] 护盾：需连续答对2题破盾
- [ ] 变身：Boss第二阶段HP回满+形态变化
- [ ] 性格系统：不同性格行为偏好正确
- [ ] 现有9种行为视觉升级效果

#### 第三轮：试炼之塔
- [ ] 解锁条件：通关2个模块Normal
- [ ] 塔层选择界面正确显示
- [ ] 1-9层入门区正常
- [ ] 第10层Boss战正常
- [ ] 11-19层试炼区正常
- [ ] 第20层中Boss两阶段战正常
- [ ] 21-29层炼狱区正常
- [ ] 第30层最终Boss三阶段正常
- [ ] 进度持久化（退出后恢复）
- [ ] HP跨层保持
- [ ] 塔专属卡牌掉落
- [ ] 掉率加成生效

#### 第四轮：卡牌系统
- [ ] 卡牌正面新布局：模块色框+emoji+名称+flavor+描述+数值
- [ ] 5种卡牌类型正确分类（知识/怪物/法术/传说/神话）
- [ ] N 级无光效、R 级微光、SR 旋转渐变边框、SSR 金色呼吸、UR 彩虹棱镜
- [ ] 详情页完整展示：背景故事、数学知识点、获取方式、系列进度、关联卡牌
- [ ] 怪物卡详情页显示 ATK/DEF/属性/台词
- [ ] 法术卡详情页显示效果/触发条件/持续时间
- [ ] 三维筛选组合正常（模块×稀有度×状态）
- [ ] 8个系列收集页各模块主题色正确
- [ ] 系列集齐奖励正确触发
- [ ] 新卡 "NEW" 角标显示，查看后消失
- [ ] 重复卡转化为数学水晶，水晶数量正确
- [ ] 水晶商店兑换功能正常
- [ ] UR 卡在图鉴中有悬浮+流光效果

#### 第五轮：音效系统
- [ ] 攻击音效分级：5个连击阶段攻击音不同
- [ ] 命中音效分级：5个连击阶段命中音不同
- [ ] 连击切换音效：进入觉醒/战意/超神/无敌各有独特音效
- [ ] 连击断裂音效：碎裂感明显
- [ ] 怪物性格分化：6种性格怪物攻击音不同
- [ ] 9种旧行为全部有音效（补全5种原来缺失的）
- [ ] 5种新行为全部有音效
- [ ] 试炼之塔：入塔/升层/Boss门/氛围音/胜利/失败音效
- [ ] 塔内3个区域氛围音有差异（入门=静谧/试炼=紧张/炼狱=压迫）
- [ ] 终结技音效有史诗感，与普通攻击明显区分
- [ ] 音效不堆积：快速连续答题时前一个音效不与后一个冲突
- [ ] 关闭音效设置后所有新音效均静音

#### 第五轮：试炼之塔视觉
- [ ] 塔内舞台背景与普通模块有明显差异（暗色+火把）
- [ ] 3个区域氛围粒子不同（萤火/火星/暗雾）
- [ ] 塔怪物登场动画与普通怪物不同
- [ ] 塔怪物攻击动画按层级递进（入门→试炼→炼狱→Boss）
- [ ] Boss登场有专属震撼动画
- [ ] 层间过渡动画流畅
- [ ] 融合题标识清晰（显示涉及模块图标）

#### 第六轮：质量测试
- [ ] 控制台无 error
- [ ] 无 timer 泄漏
- [ ] iPad Safari 60fps
- [ ] 非战斗功能不受影响（练习/每日/错题本）
- [ ] 终结技动画粒子不超限
- [ ] 同时活跃的 OscillatorNode 不超过 6 个
- [ ] 塔内环境音退出后立即停止
- [ ] 内存无持续增长

---

## 十二、产品经理待确认事项

1. **连击保护机制**：连击护盾（10连后首次答错不清零）是否会降低难度？是否只在 Easy 开启？
2. **试炼之塔难度曲线**：30层会不会太长？是否改为 20 层更紧凑？
3. **试炼之塔重置周期**：每日重置还是每周重置？
4. **数学魔神三阶段**：最终 Boss 三阶段战斗时长约 5-8 分钟，是否可接受？
5. **诅咒行为**：选项增加到 5 个是否对低年级孩子太难？是否只在 Hard 和试炼之塔中出现？
6. **变身机制**：Boss 变身后 HP 回满会不会太挫败？是否改为回复 50%？
7. **终结技频率**：15 连击触发终结技是否太稀有？是否改为 12 连击？
8. **怪物性格可见性**：是否在怪物名字旁显示性格图标让玩家提前知晓？
9. **试炼之塔解锁条件**："通关 2 个模块 Normal" 是否合适？还是改为 "累计胜利 10 场"？
10. **新卡牌总数**：加上试炼之塔 10 张，总计 134 张（原 124 + 10）。是否需要其他模块也各加几张？
11. **塔内环境音**：试炼之塔背景环境音是持续播放还是间歇式？持续播放可能让孩子觉得吵？
12. **终结技音效时长**：无敌攻击音效约 1s，是否太长影响答题节奏？
13. **怪物攻击音按性格分化**：6种不同攻击音会不会让孩子困惑？还是统一保持现有音效更好？
14. **融合题**：跨模块融合题（如分数×乘法）是否需要提前在某个地方教学或提示？
15. **卡牌背景故事篇幅**：N 卡故事 50 字、R 卡 80 字、UR 卡 120 字，这个长度是否合适？低年级孩子会不会不看？
16. **实体卡牌**：v16.0 先做好数据和视觉设计，是否后续版本再做"导出打印 PDF"功能？
17. **数学水晶货币**：重复卡转化为水晶的商店系统是否太复杂？是否简化为只能兑换卡牌背面皮肤？
18. **卡牌 ATK/DEF 数值**：知识卡是否需要战斗数值？还是只有怪物卡和法术卡有数值？
19. **集齐奖励**：系列集齐奖励是纯成就展示，还是给予实际战斗加成（如集齐小九九系列 ATK+1）？

---

## 附录 A：v15.0 遗留优化项

- [ ] N01 每日首胜奖励
- [ ] N02 战斗结算展示怪兽
- [ ] N03 新手引导教学关
- [ ] U01 z-index 标准化
- [ ] U02 iOS Safe Area 适配
- [ ] U05 iPad 横屏适配

## 附录 B：当前系统规模统计（v15.0）

| 指标 | 数量 |
|------|------|
| JS 文件 | 16 个 |
| 怪物总数 | ~450 只 |
| 怪物行为 | 9 种 |
| 卡牌总数 | 124 张 |
| 成就总数 | ~40 个 |
| CSS 动画 | ~45 个 @keyframes |
| 音效 | 22 种 |
| 粒子特效 | 8 种 |
| 模块 | 6 个 |

## 附录 C：v16.0 后系统规模预估

| 指标 | v15.0 | v16.0 | 增量 |
|------|-------|-------|------|
| JS 文件 | 16 | 21 | +5 |
| 怪物总数 | ~450 | ~522 | +72 |
| 怪物行为 | 9 | 14 | +5 |
| 怪物性格 | 0 | 6 | +6 |
| 卡牌总数 | 124(143*) | 153 | +10新卡 |
| 卡牌类型 | 1 | 5 | +4 |
| 卡牌字段数 | 7-8 | 18-22 | +11~14 |
| 图鉴筛选维度 | 1 | 3 | +2 |
| 系列收集页 | 0 | 8 | +8 |
| 成就总数 | ~40 | ~60 | +20 |
| CSS 动画 | ~45 | ~70 | +25 |
| 音效 | 22 | ~59 | +37 |
| 粒子特效 | 8 | ~13 | +5 |
| 模块 | 6 | 6+塔 | +1 |
| 攻击模式 | 1 | 5 | +4 |

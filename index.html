<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

    <!-- 禁止缓存 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- iOS PWA 配置 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="数学魔法学院">
    <meta name="mobile-web-app-capable" content="yes">

    <!-- 禁用自动检测 -->
    <meta name="format-detection" content="telephone=no">
    <meta name="format-detection" content="date=no">
    <meta name="format-detection" content="address=no">
    <meta name="format-detection" content="email=no">

    <!-- SEO -->
    <meta name="description" content="专为3-4年级小学生设计的数学速算训练工具，帮助快速掌握乘法速记、分数小数互换等技巧">
    <meta property="og:title" content="数学魔法学院">
    <meta property="og:description" content="让数学计算变得又快又准！">
    <meta name="theme-color" content="#6C5CE7">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- 图标 -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180.png">

    <!-- 启动画面（iPad） -->
    <link rel="apple-touch-startup-image" href="icons/splash.png">

    <title>数学魔法学院</title>
    <link rel="stylesheet" href="css/style.css?v=23.2">
    <link rel="stylesheet" href="css/scenes.css?v=23.2">
    <link rel="stylesheet" href="css/scenes-svg.css?v=23.2">
    <link rel="stylesheet" href="css/knowledge.css?v=23.2">
</head>
<body>
    <!-- 主页面 -->
    <div id="app">
        <!-- 用户选择页 -->
        <div id="user-page" class="page active">
            <div class="user-select-container">
                <h1 class="user-select-title">🧒 选择小朋友</h1>
                <p class="user-select-subtitle">点击头像开始练习</p>

                <div class="user-list" id="user-list">
                    <!-- 动态填充用户列表 -->
                </div>

                <div class="add-user-section">
                    <button class="add-user-btn" id="add-user-btn">
                        <span class="add-icon">+</span>
                        <span>添加新用户</span>
                    </button>
                </div>

                <!-- 新建用户表单 -->
                <div class="new-user-form hidden" id="new-user-form">
                    <input type="text" class="user-name-input" id="user-name-input" placeholder="输入名字" maxlength="10">
                    <div class="avatar-picker" id="avatar-picker">
                        <div class="avatar-option selected" data-avatar="⚔️">
                            <span class="avatar-emoji">⚔️</span><span class="avatar-role">剑士</span>
                        </div>
                        <div class="avatar-option" data-avatar="🧙">
                            <span class="avatar-emoji">🧙</span><span class="avatar-role">魔法师</span>
                        </div>
                        <div class="avatar-option" data-avatar="🏹">
                            <span class="avatar-emoji">🏹</span><span class="avatar-role">弓箭手</span>
                        </div>
                        <div class="avatar-option" data-avatar="🛡️">
                            <span class="avatar-emoji">🛡️</span><span class="avatar-role">守护者</span>
                        </div>
                        <div class="avatar-option" data-avatar="🐉">
                            <span class="avatar-emoji">🐉</span><span class="avatar-role">驯龙师</span>
                        </div>
                        <div class="avatar-option" data-avatar="🦊">
                            <span class="avatar-emoji">🦊</span><span class="avatar-role">灵狐</span>
                        </div>
                        <div class="avatar-option" data-avatar="🌟">
                            <span class="avatar-emoji">🌟</span><span class="avatar-role">星术士</span>
                        </div>
                        <div class="avatar-option" data-avatar="🔮">
                            <span class="avatar-emoji">🔮</span><span class="avatar-role">预言家</span>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button class="form-btn cancel" id="cancel-add-user">取消</button>
                        <button class="form-btn confirm" id="confirm-add-user">确定</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 首页 -->
        <div id="home-page" class="page">
            <header class="home-header">
                <div class="user-badge" id="current-user-badge">
                    <span class="user-avatar" id="current-avatar">⚔️</span>
                    <span class="user-name" id="current-name">小朋友</span>
                    <span class="switch-hint">点击切换</span>
                </div>
                <h1>🔮 数学魔法学院</h1>
                <p class="subtitle">魔法学徒，今天要挑战哪个副本？</p>
            </header>

            <div class="stats-bar">
                <div class="stat-item">
                    <span class="stat-icon">🔥</span>
                    <span class="stat-value" id="streak-count">0</span>
                    <span class="stat-label">最高连胜</span>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">📝</span>
                    <span class="stat-value" id="today-count">0</span>
                    <span class="stat-label">今日练习</span>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">⭐</span>
                    <span class="stat-value" id="total-score">0</span>
                    <span class="stat-label">总分</span>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">📚</span>
                    <span class="stat-value" id="wrong-count">0</span>
                    <span class="stat-label">错题</span>
                </div>
            </div>

            <!-- 冒险副本 -->
            <div class="menu-section">
                <div class="menu-section-title">⚔️ 冒险副本</div>
                <div class="menu-grid">
                    <button class="menu-btn xiaojiujiu-btn" data-module="xiaojiujiu">
                        <span class="menu-icon">🔥</span>
                        <span class="menu-title">小九九速算</span>
                        <span class="menu-desc">专攻6×7、7×8等难点</span>
                    </button>

                    <button class="menu-btn times-btn" data-module="times">
                        <span class="menu-icon">📊</span>
                        <span class="menu-title">大九九表</span>
                        <span class="menu-desc">11-19乘法 + 平方数</span>
                    </button>

                    <button class="menu-btn" data-module="multiply">
                        <span class="menu-icon">🔢</span>
                        <span class="menu-title">乘法速记</span>
                        <span class="menu-desc">25×4=100 看到4想25</span>
                    </button>

                    <button class="menu-btn" data-module="fraction">
                        <span class="menu-icon">🔄</span>
                        <span class="menu-title">分数小数</span>
                        <span class="menu-desc">1/8=0.125 必背互换</span>
                    </button>

                    <button class="menu-btn" data-module="decimal">
                        <span class="menu-icon">➗</span>
                        <span class="menu-title">小数规律</span>
                        <span class="menu-desc">乘除10小数点移动</span>
                    </button>

                    <button class="menu-btn" data-module="unit">
                        <span class="menu-icon">📐</span>
                        <span class="menu-title">单位换算</span>
                        <span class="menu-desc">长度·质量·面积·容积·时间·人民币</span>
                    </button>
                </div>
            </div>

            <!-- 试炼场 -->
            <div class="menu-section">
                <div class="menu-section-title">🏟️ 试炼场</div>
                <div class="menu-grid">
                    <button class="menu-btn daily-dungeon-btn" data-module="daily" id="daily-dungeon-btn">
                        <span class="menu-icon">🗡️</span>
                        <span class="menu-title">每日副本</span>
                        <span class="menu-desc">每日10题限时闯关</span>
                    </button>

                    <button class="menu-btn trial-tower-btn" data-module="mixed" id="trial-tower-btn">
                        <span class="menu-icon">🗼</span>
                        <span class="menu-title">试炼之塔</span>
                        <span class="menu-desc">全题型混合挑战</span>
                    </button>
                </div>
            </div>

            <!-- 冒险工具 -->
            <div class="menu-section">
                <div class="menu-section-title">🛠️ 冒险工具</div>
                <div class="tools-grid">
                    <button class="menu-btn learn-btn" data-module="learn">
                        <span class="menu-icon">📜</span>
                        <span class="menu-title">秘术卷轴</span>
                        <span class="menu-desc">速算技巧与魔法秘笈</span>
                    </button>

                    <button class="menu-btn wrong-book-btn" data-module="wrong">
                        <span class="menu-icon">📖</span>
                        <span class="menu-title">魔法残页</span>
                        <span class="menu-desc">修复答错的魔咒</span>
                    </button>

                    <button class="menu-btn" data-module="achievements" id="achievements-btn">
                        <span class="menu-icon">🏅</span>
                        <span class="menu-title">成就殿堂</span>
                        <span class="menu-desc">查看成就与收集</span>
                    </button>

                    <button class="menu-btn card-collection-btn" id="open-card-collection">
                        <span class="menu-icon">🃏</span>
                        <span class="menu-title">卡牌图鉴</span>
                        <span class="menu-desc">收集战斗掉落卡牌</span>
                    </button>
                </div>
            </div>

            <footer class="home-footer">
                <button class="link-btn" id="settings-btn">🔮 设置</button>
            </footer>
        </div>

        <!-- 秘术卷轴 — 学习+知识追踪 -->
        <div id="learn-page" class="page knowledge-page">
            <header class="page-header knowledge-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>📜 秘术卷轴</h2>
                <div class="header-spacer"></div>
            </header>

            <div class="learn-content" id="learn-content">
                <!-- 由 KnowledgeUI.render() 动态填充 -->
            </div>
        </div>

        <!-- 训练页面 -->
        <div id="practice-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2 id="practice-title">训练</h2>
                <div class="practice-stats">
                    <span id="correct-count">0</span>/<span id="total-count">0</span>
                </div>
            </header>

            <div class="difficulty-selector" id="difficulty-selector">
                <span>难度：</span>
                <button class="diff-btn active" data-diff="easy">简单</button>
                <button class="diff-btn" data-diff="normal">普通</button>
                <button class="diff-btn" data-diff="hard">困难</button>
            </div>

            <div class="timer-bar" id="timer-bar">
                <div class="timer-progress" id="timer-progress"></div>
            </div>

            <div class="question-area">
                <div class="question-card" id="question-card">
                    <div class="question-text" id="question-text">25 × 4 = ?</div>
                </div>

                <div class="streak-indicator" id="streak-indicator">
                    <span class="streak-fire">🔥</span>
                    <span class="streak-num" id="current-streak">0</span>
                </div>
            </div>

            <div class="answer-area" id="answer-area">
                <!-- 选择题模式 -->
                <div class="choices" id="choices">
                    <button class="choice-btn">100</button>
                    <button class="choice-btn">125</button>
                    <button class="choice-btn">80</button>
                    <button class="choice-btn">75</button>
                </div>

                <!-- 填空题模式 -->
                <div class="input-mode hidden" id="input-mode">
                    <input type="text" inputmode="decimal" class="answer-input" id="answer-input" placeholder="输入答案">
                    <button class="submit-btn" id="submit-btn">确定</button>
                </div>
            </div>

            <div class="feedback" id="feedback">
                <div class="feedback-content">
                    <span class="feedback-icon"></span>
                    <span class="feedback-text"></span>
                </div>
            </div>
        </div>

        <!-- 每日挑战页 -->
        <div id="daily-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>🗡️ 每日副本</h2>
                <div class="daily-timer" id="daily-timer">00:00</div>
            </header>

            <div class="daily-progress">
                <div class="progress-dots" id="progress-dots">
                    <!-- 10个点 -->
                </div>
            </div>

            <div class="question-area">
                <div class="question-card" id="daily-question-card">
                    <div class="question-text" id="daily-question-text">准备好了吗？</div>
                </div>
            </div>

            <div class="answer-area">
                <div class="choices" id="daily-choices">
                    <button class="start-daily-btn" id="start-daily">出发闯关！</button>
                </div>
            </div>

            <div class="feedback" id="daily-feedback">
                <div class="feedback-content">
                    <span class="feedback-icon"></span>
                    <span class="feedback-text"></span>
                </div>
            </div>
        </div>

        <!-- 结果页 -->
        <div id="result-page" class="page">
            <div class="result-content">
                <div class="result-icon" id="result-icon">🎉</div>
                <h2 class="result-title" id="result-title">太棒了！</h2>
                <p class="result-encourage" id="result-encourage">每天进步一点点，积少成多大不同！</p>
                <div class="result-stats">
                    <div class="result-stat">
                        <span class="result-value" id="result-correct">8</span>
                        <span class="result-label">答对</span>
                    </div>
                    <div class="result-stat">
                        <span class="result-value" id="result-total">10</span>
                        <span class="result-label">总题数</span>
                    </div>
                    <div class="result-stat">
                        <span class="result-value" id="result-time">45s</span>
                        <span class="result-label">用时</span>
                    </div>
                </div>
                <div class="result-accuracy">
                    <div class="accuracy-bar">
                        <div class="accuracy-fill" id="accuracy-fill"></div>
                    </div>
                    <span class="accuracy-text" id="accuracy-text">正确率 80%</span>
                </div>
                <div class="result-actions">
                    <button class="result-btn primary" id="retry-btn">再来一次</button>
                    <button class="result-btn" id="home-btn">返回首页</button>
                </div>
            </div>
        </div>

        <!-- 错题本页 -->
        <div id="wrong-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>📖 魔法残页</h2>
                <button class="clear-wrong-btn" id="clear-wrong">清空</button>
            </header>

            <div class="wrong-list" id="wrong-list">
                <!-- 动态填充 -->
            </div>

            <div class="wrong-empty hidden" id="wrong-empty">
                <span class="empty-icon">✨</span>
                <p>太棒了！没有残页</p>
            </div>

            <div class="wrong-actions" id="wrong-actions">
                <button class="practice-wrong-btn" id="practice-wrong">修复魔咒</button>
            </div>
        </div>

        <!-- 设置页 -->
        <div id="settings-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>🔮 魔法设置</h2>
                <div class="header-spacer"></div>
            </header>

            <div class="settings-list">
                <div class="setting-item">
                    <span class="setting-label">⚔️ 战斗方式</span>
                    <div class="setting-options">
                        <button class="setting-opt active" data-setting="mode" data-value="choice">选择题</button>
                        <button class="setting-opt" data-setting="mode" data-value="input">填空题</button>
                    </div>
                </div>

                <div class="setting-item">
                    <span class="setting-label">⏱️ 时间魔法</span>
                    <div class="setting-options">
                        <button class="setting-opt active" data-setting="timer" data-value="off">关闭</button>
                        <button class="setting-opt" data-setting="timer" data-value="on">开启</button>
                    </div>
                </div>

                <div class="setting-item">
                    <span class="setting-label">📊 每轮题数</span>
                    <div class="setting-options">
                        <button class="setting-opt" data-setting="count" data-value="10">10题</button>
                        <button class="setting-opt active" data-setting="count" data-value="20">20题</button>
                        <button class="setting-opt" data-setting="count" data-value="50">50题</button>
                    </div>
                </div>

                <div class="setting-item">
                    <span class="setting-label">🔊 音效魔法</span>
                    <div class="setting-options">
                        <button class="setting-opt active" data-setting="sound" data-value="on">开启</button>
                        <button class="setting-opt" data-setting="sound" data-value="off">关闭</button>
                    </div>
                </div>
            </div>

            <div class="settings-footer">
                <button class="reset-btn" id="reset-progress">重置所有进度</button>
                <p class="version">版本 18.0</p>
            </div>
        </div>

        <!-- 成就页 -->
        <div id="achievements-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>🏅 成就殿堂</h2>
                <div class="header-spacer"></div>
            </header>

            <div class="achievements-summary" id="achievements-summary">
                <!-- dynamically filled: X/24 成就已解锁 -->
            </div>

            <div class="achievements-grid" id="achievements-grid">
                <!-- 动态填充 -->
            </div>
        </div>

        <!-- 小九九模式选择页 -->
        <div id="xiaojiujiu-mode-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>🔥 小九九速算</h2>
                <div class="header-spacer"></div>
            </header>

            <div class="mode-select-container">
                <h3 class="mode-select-title">选择训练模式</h3>

                <!-- v23.0: 冒险闯关 — 主推入口 -->
                <div class="chapter-section">
                    <div class="chapter-section-header">
                        <span class="chapter-section-icon">⚔️</span>
                        <span class="chapter-section-label">冒险闯关</span>
                        <span class="chapter-progress-badge" id="chapter-progress-display">0/9 ⭐</span>
                    </div>
                    <div class="chapter-cards-row" id="chapter-cards-container">
                        <!-- 动态填充章节卡片 -->
                    </div>
                </div>

                <!-- 难度选择 + 经典战斗/练习 -->
                <div class="battle-difficulty-selector">
                    <span class="diff-label">难度：</span>
                    <button class="battle-diff-btn active" data-diff="easy">
                        <span class="diff-icon">😊</span>
                        <span class="diff-text">简单</span>
                    </button>
                    <button class="battle-diff-btn" data-diff="normal">
                        <span class="diff-icon">😤</span>
                        <span class="diff-text">普通</span>
                    </button>
                    <button class="battle-diff-btn" data-diff="hard">
                        <span class="diff-icon">😈</span>
                        <span class="diff-text">困难</span>
                    </button>
                </div>

                <button class="mode-card battle-mode" id="select-battle-mode">
                    <span class="mode-icon">⚔️</span>
                    <span class="mode-name">怪兽战斗</span>
                    <span class="mode-desc">消灭怪兽，拯救数学王国！</span>
                </button>

                <button class="mode-card classic-mode" id="select-classic-mode">
                    <span class="mode-icon">📝</span>
                    <span class="mode-name">经典练习</span>
                    <span class="mode-desc">专注练习，稳步提升</span>
                </button>

                <button class="mode-card collection-mode" id="open-collection">
                    <span class="mode-icon">📖</span>
                    <span class="mode-name">妖怪图鉴</span>
                    <span class="mode-desc">查看收集的妖怪</span>
                    <span class="collection-count" id="collection-count">0/53</span>
                </button>
            </div>
        </div>

        <!-- 分数小数 模式选择页 -->
        <div id="fraction-mode-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>🔄 分数小数互换</h2>
                <div class="header-spacer"></div>
            </header>

            <div class="mode-select-container">
                <h3 class="mode-select-title">选择训练模式</h3>

                <!-- v23.2: 冒险闯关 -->
                <div class="chapter-section">
                    <div class="chapter-section-header">
                        <span class="chapter-section-icon">⚔️</span>
                        <span class="chapter-section-label">冒险闯关</span>
                        <span class="chapter-progress-badge" id="fraction-chapter-progress-display">0/9 ⭐</span>
                    </div>
                    <div class="chapter-cards-row" id="fraction-chapter-cards-container">
                        <!-- 动态填充章节卡片 -->
                    </div>
                </div>

                <!-- 难度选择 -->
                <div class="battle-difficulty-selector">
                    <span class="diff-label">难度：</span>
                    <button class="battle-diff-btn fraction-diff-btn active" data-diff="easy">
                        <span class="diff-icon">😊</span>
                        <span class="diff-text">简单</span>
                    </button>
                    <button class="battle-diff-btn fraction-diff-btn" data-diff="normal">
                        <span class="diff-icon">😤</span>
                        <span class="diff-text">普通</span>
                    </button>
                    <button class="battle-diff-btn fraction-diff-btn" data-diff="hard">
                        <span class="diff-icon">😈</span>
                        <span class="diff-text">困难</span>
                    </button>
                </div>

                <button class="mode-card battle-mode" id="select-fraction-battle-mode">
                    <span class="mode-icon">⚔️</span>
                    <span class="mode-name">山海经大冒险</span>
                    <span class="mode-desc">挑战山海经妖怪，征服分数小数！</span>
                    <span class="mode-tag">推荐</span>
                </button>

                <button class="mode-card classic-mode" id="select-fraction-classic-mode">
                    <span class="mode-icon">📝</span>
                    <span class="mode-name">经典模式</span>
                    <span class="mode-desc">专注练习，稳步提升</span>
                </button>

                <button class="mode-card collection-mode" id="open-fraction-collection">
                    <span class="mode-icon">📜</span>
                    <span class="mode-name">山海经图鉴</span>
                    <span class="mode-desc">查看收集的山海经妖怪</span>
                    <span class="collection-count" id="fraction-collection-count">0/72</span>
                </button>
            </div>
        </div>

        <!-- 小数规律 模式选择页 -->
        <div id="decimal-mode-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>➗ 小数规律</h2>
                <div class="header-spacer"></div>
            </header>

            <div class="mode-select-container">
                <h3 class="mode-select-title">选择训练模式</h3>

                <!-- v23.2: 冒险闯关 -->
                <div class="chapter-section">
                    <div class="chapter-section-header">
                        <span class="chapter-section-icon">⚔️</span>
                        <span class="chapter-section-label">冒险闯关</span>
                        <span class="chapter-progress-badge" id="decimal-chapter-progress-display">0/9 ⭐</span>
                    </div>
                    <div class="chapter-cards-row" id="decimal-chapter-cards-container">
                        <!-- 动态填充章节卡片 -->
                    </div>
                </div>

                <!-- 难度选择 -->
                <div class="battle-difficulty-selector">
                    <span class="diff-label">难度：</span>
                    <button class="battle-diff-btn decimal-diff-btn active" data-diff="easy">
                        <span class="diff-icon">😊</span>
                        <span class="diff-text">简单</span>
                    </button>
                    <button class="battle-diff-btn decimal-diff-btn" data-diff="normal">
                        <span class="diff-icon">😤</span>
                        <span class="diff-text">普通</span>
                    </button>
                    <button class="battle-diff-btn decimal-diff-btn" data-diff="hard">
                        <span class="diff-icon">😈</span>
                        <span class="diff-text">困难</span>
                    </button>
                </div>

                <button class="mode-card battle-mode" id="select-decimal-battle-mode">
                    <span class="mode-icon">⚔️</span>
                    <span class="mode-name">西游记大冒险</span>
                    <span class="mode-desc">挑战西游记妖怪，征服小数规律！</span>
                    <span class="mode-tag">推荐</span>
                </button>

                <button class="mode-card classic-mode" id="select-decimal-classic-mode">
                    <span class="mode-icon">📝</span>
                    <span class="mode-name">经典模式</span>
                    <span class="mode-desc">专注练习，稳步提升</span>
                </button>

                <button class="mode-card collection-mode" id="open-decimal-collection">
                    <span class="mode-icon">📖</span>
                    <span class="mode-name">西游记图鉴</span>
                    <span class="mode-desc">查看收集的西游记妖怪</span>
                    <span class="collection-count" id="decimal-collection-count">0/72</span>
                </button>
            </div>
        </div>

        <!-- 西游记图鉴页 -->
        <div id="xiyouji-collection-page" class="page">
            <header class="collection-header xiyouji-header">
                <button class="back-btn" id="xiyouji-collection-back-btn">← 返回</button>
                <h1>📖 西游记图鉴</h1>
                <div class="collection-stats" id="xiyouji-collection-stats">0/72</div>
            </header>

            <div class="collection-banner xiyouji-banner">
                <div class="collection-banner-bg xiyouji-banner-bg"></div>
                <div class="collection-banner-content">
                    <div class="collection-progress-ring">
                        <svg viewBox="0 0 80 80">
                            <circle cx="40" cy="40" r="35" class="progress-bg"/>
                            <circle cx="40" cy="40" r="35" class="progress-fill xiyouji-ring" id="xiyouji-ring-fill"/>
                        </svg>
                        <span class="progress-percent" id="xiyouji-percent">0%</span>
                    </div>
                    <div class="collection-banner-info">
                        <div class="collection-banner-title">西游记收集进度</div>
                        <div class="collection-banner-count" id="xiyouji-banner-count">0 / 72</div>
                        <div class="collection-banner-desc">征服小数规律，收录西游记妖怪</div>
                    </div>
                </div>
            </div>

            <div class="collection-filters">
                <button class="collection-filter-btn xiyouji-filter active" data-filter="all">
                    <span class="filter-icon">📋</span> 全部
                </button>
                <button class="collection-filter-btn xiyouji-filter" data-filter="collected">
                    <span class="filter-icon">✅</span> 已收集
                </button>
                <button class="collection-filter-btn xiyouji-filter" data-filter="locked">
                    <span class="filter-icon">🔒</span> 未解锁
                </button>
            </div>

            <div class="collection-grid" id="xiyouji-collection-grid">
                <!-- 动态生成西游记妖怪卡片 -->
            </div>
        </div>

        <!-- 单位换算 模式选择页 -->
        <div id="unit-mode-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>📐 单位换算</h2>
                <div class="header-spacer"></div>
            </header>

            <div class="mode-select-container">
                <h3 class="mode-select-title">选择训练模式</h3>

                <!-- v23.2: 冒险闯关 -->
                <div class="chapter-section">
                    <div class="chapter-section-header">
                        <span class="chapter-section-icon">⚔️</span>
                        <span class="chapter-section-label">冒险闯关</span>
                        <span class="chapter-progress-badge" id="unit-chapter-progress-display">0/9 ⭐</span>
                    </div>
                    <div class="chapter-cards-row" id="unit-chapter-cards-container">
                        <!-- 动态填充章节卡片 -->
                    </div>
                </div>

                <!-- 难度选择 -->
                <div class="battle-difficulty-selector">
                    <span class="diff-label">难度：</span>
                    <button class="battle-diff-btn unit-diff-btn active" data-diff="easy">
                        <span class="diff-icon">😊</span>
                        <span class="diff-text">简单</span>
                    </button>
                    <button class="battle-diff-btn unit-diff-btn" data-diff="normal">
                        <span class="diff-icon">😤</span>
                        <span class="diff-text">普通</span>
                    </button>
                    <button class="battle-diff-btn unit-diff-btn" data-diff="hard">
                        <span class="diff-icon">😈</span>
                        <span class="diff-text">困难</span>
                    </button>
                </div>

                <button class="mode-card battle-mode" id="select-unit-battle-mode">
                    <span class="mode-icon">⚔️</span>
                    <span class="mode-name">封神演义大冒险</span>
                    <span class="mode-desc">挑战封神演义妖怪，征服单位换算！</span>
                    <span class="mode-tag">推荐</span>
                </button>

                <button class="mode-card collection-mode" id="open-unit-collection">
                    <span class="mode-icon">📜</span>
                    <span class="mode-name">封神演义图鉴</span>
                    <span class="mode-desc">查看收集的封神演义妖怪</span>
                    <span class="collection-count" id="unit-collection-count">0/72</span>
                </button>
            </div>
        </div>

        <!-- 封神演义图鉴页 -->
        <div id="fengshen-collection-page" class="page">
            <header class="collection-header fengshen-header">
                <button class="back-btn" id="fengshen-collection-back-btn">← 返回</button>
                <h1>📜 封神演义图鉴</h1>
                <div class="collection-stats" id="fengshen-collection-stats">0/72</div>
            </header>

            <div class="collection-banner fengshen-banner">
                <div class="collection-banner-bg fengshen-banner-bg"></div>
                <div class="collection-banner-content">
                    <div class="collection-progress-ring">
                        <svg viewBox="0 0 80 80">
                            <circle cx="40" cy="40" r="35" class="progress-bg"/>
                            <circle cx="40" cy="40" r="35" class="progress-fill fengshen-ring" id="fengshen-ring-fill"/>
                        </svg>
                        <span class="progress-percent" id="fengshen-percent">0%</span>
                    </div>
                    <div class="collection-banner-info">
                        <div class="collection-banner-title">封神演义收集进度</div>
                        <div class="collection-banner-count" id="fengshen-banner-count">0 / 72</div>
                        <div class="collection-banner-desc">征服单位换算，收录封神演义妖怪</div>
                    </div>
                </div>
            </div>

            <div class="collection-filters">
                <button class="collection-filter-btn fengshen-filter active" data-filter="all">
                    <span class="filter-icon">📋</span> 全部
                </button>
                <button class="collection-filter-btn fengshen-filter" data-filter="collected">
                    <span class="filter-icon">✅</span> 已收集
                </button>
                <button class="collection-filter-btn fengshen-filter" data-filter="locked">
                    <span class="filter-icon">🔒</span> 未解锁
                </button>
            </div>

            <div class="collection-grid" id="fengshen-collection-grid">
                <!-- 动态生成封神演义妖怪卡片 -->
            </div>
        </div>

        <!-- 乘法速记 模式选择页 -->
        <div id="multiply-mode-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>🔢 乘法速记</h2>
                <div class="header-spacer"></div>
            </header>

            <div class="mode-select-container">
                <h3 class="mode-select-title">选择训练模式</h3>

                <!-- v23.2: 冒险闯关 -->
                <div class="chapter-section">
                    <div class="chapter-section-header">
                        <span class="chapter-section-icon">⚔️</span>
                        <span class="chapter-section-label">冒险闯关</span>
                        <span class="chapter-progress-badge" id="multiply-chapter-progress-display">0/9 ⭐</span>
                    </div>
                    <div class="chapter-cards-row" id="multiply-chapter-cards-container">
                        <!-- 动态填充章节卡片 -->
                    </div>
                </div>

                <!-- 难度选择 -->
                <div class="battle-difficulty-selector">
                    <span class="diff-label">难度：</span>
                    <button class="battle-diff-btn multiply-diff-btn active" data-diff="easy">
                        <span class="diff-icon">😊</span>
                        <span class="diff-text">简单</span>
                    </button>
                    <button class="battle-diff-btn multiply-diff-btn" data-diff="normal">
                        <span class="diff-icon">😤</span>
                        <span class="diff-text">普通</span>
                    </button>
                    <button class="battle-diff-btn multiply-diff-btn" data-diff="hard">
                        <span class="diff-icon">😈</span>
                        <span class="diff-text">困难</span>
                    </button>
                </div>

                <button class="mode-card battle-mode" id="select-multiply-battle-mode">
                    <span class="mode-icon">⚔️</span>
                    <span class="mode-name">聊斋大作战</span>
                    <span class="mode-desc">挑战聊斋志异妖怪，征服乘法速记！</span>
                    <span class="mode-tag">推荐</span>
                </button>

                <button class="mode-card classic-mode" id="select-multiply-classic-mode">
                    <span class="mode-icon">📝</span>
                    <span class="mode-name">经典模式</span>
                    <span class="mode-desc">专注练习，稳步提升</span>
                </button>

                <button class="mode-card collection-mode" id="open-multiply-collection">
                    <span class="mode-icon">👻</span>
                    <span class="mode-name">聊斋志异图鉴</span>
                    <span class="mode-desc">查看收集的聊斋志异鬼怪</span>
                    <span class="collection-count" id="multiply-collection-count">0/44</span>
                </button>
            </div>
        </div>

        <!-- 聊斋志异图鉴页 -->
        <div id="liaozhai-collection-page" class="page">
            <header class="collection-header liaozhai-header">
                <button class="back-btn" id="liaozhai-collection-back-btn">← 返回</button>
                <h1>👻 聊斋志异图鉴</h1>
                <div class="collection-stats" id="liaozhai-collection-stats">0/44</div>
            </header>

            <div class="collection-banner liaozhai-banner">
                <div class="collection-banner-bg liaozhai-banner-bg"></div>
                <div class="collection-banner-content">
                    <div class="collection-progress-ring">
                        <svg viewBox="0 0 80 80">
                            <circle cx="40" cy="40" r="35" class="progress-bg"/>
                            <circle cx="40" cy="40" r="35" class="progress-fill liaozhai-ring" id="liaozhai-ring-fill"/>
                        </svg>
                        <span class="progress-percent" id="liaozhai-percent">0%</span>
                    </div>
                    <div class="collection-banner-info">
                        <div class="collection-banner-title">聊斋志异收集进度</div>
                        <div class="collection-banner-count" id="liaozhai-banner-count">0 / 44</div>
                        <div class="collection-banner-desc">征服乘法速记，收录聊斋鬼怪</div>
                    </div>
                </div>
            </div>

            <div class="collection-filters">
                <button class="collection-filter-btn liaozhai-filter active" data-filter="all">
                    <span class="filter-icon">📋</span> 全部
                </button>
                <button class="collection-filter-btn liaozhai-filter" data-filter="collected">
                    <span class="filter-icon">✅</span> 已收集
                </button>
                <button class="collection-filter-btn liaozhai-filter" data-filter="locked">
                    <span class="filter-icon">🔒</span> 未解锁
                </button>
            </div>

            <div class="collection-grid" id="liaozhai-collection-grid">
                <!-- 动态生成聊斋志异鬼怪卡片 -->
            </div>
        </div>

        <!-- 大九九表 模式选择页 -->
        <div id="times-mode-page" class="page">
            <header class="page-header">
                <button class="back-btn" data-target="home">← 返回</button>
                <h2>📊 大九九表 + 平方数</h2>
                <div class="header-spacer"></div>
            </header>

            <div class="mode-select-container">
                <h3 class="mode-select-title">选择训练模式</h3>

                <!-- v23.2: 冒险闯关 -->
                <div class="chapter-section">
                    <div class="chapter-section-header">
                        <span class="chapter-section-icon">⚔️</span>
                        <span class="chapter-section-label">冒险闯关</span>
                        <span class="chapter-progress-badge" id="times-chapter-progress-display">0/9 ⭐</span>
                    </div>
                    <div class="chapter-cards-row" id="times-chapter-cards-container">
                        <!-- 动态填充章节卡片 -->
                    </div>
                </div>

                <!-- 难度选择 -->
                <div class="battle-difficulty-selector">
                    <span class="diff-label">难度：</span>
                    <button class="battle-diff-btn times-diff-btn active" data-diff="easy">
                        <span class="diff-icon">😊</span>
                        <span class="diff-text">简单</span>
                    </button>
                    <button class="battle-diff-btn times-diff-btn" data-diff="normal">
                        <span class="diff-icon">😤</span>
                        <span class="diff-text">普通</span>
                    </button>
                    <button class="battle-diff-btn times-diff-btn" data-diff="hard">
                        <span class="diff-icon">😈</span>
                        <span class="diff-text">困难</span>
                    </button>
                </div>

                <button class="mode-card battle-mode" id="select-times-battle-mode">
                    <span class="mode-icon">⚔️</span>
                    <span class="mode-name">霍格沃茨大冒险</span>
                    <span class="mode-desc">挑战哈利波特魔法生物，征服大九九表！</span>
                    <span class="mode-tag">推荐</span>
                </button>

                <button class="mode-card classic-mode" id="select-times-classic-mode">
                    <span class="mode-icon">📝</span>
                    <span class="mode-name">经典模式</span>
                    <span class="mode-desc">专注练习，稳步提升</span>
                </button>

                <button class="mode-card collection-mode" id="open-times-collection">
                    <span class="mode-icon">🧙</span>
                    <span class="mode-name">魔法生物图鉴</span>
                    <span class="mode-desc">查看收集的哈利波特魔法生物</span>
                    <span class="collection-count" id="times-collection-count">0/72</span>
                </button>
            </div>
        </div>

        <!-- 哈利波特魔法生物图鉴页 -->
        <div id="hp-collection-page" class="page">
            <header class="collection-header hp-header">
                <button class="back-btn" id="hp-collection-back-btn">← 返回</button>
                <h1>🧙 魔法生物图鉴</h1>
                <div class="collection-stats" id="hp-collection-stats">0/72</div>
            </header>

            <div class="collection-banner hp-banner">
                <div class="collection-banner-bg hp-banner-bg"></div>
                <div class="collection-banner-content">
                    <div class="collection-progress-ring">
                        <svg viewBox="0 0 80 80">
                            <circle cx="40" cy="40" r="35" class="progress-bg"/>
                            <circle cx="40" cy="40" r="35" class="progress-fill hp-ring" id="hp-ring-fill"/>
                        </svg>
                        <span class="progress-percent" id="hp-percent">0%</span>
                    </div>
                    <div class="collection-banner-info">
                        <div class="collection-banner-title">魔法生物收集进度</div>
                        <div class="collection-banner-count" id="hp-banner-count">0 / 72</div>
                        <div class="collection-banner-desc">征服大九九表，收录魔法生物</div>
                    </div>
                </div>
            </div>

            <div class="collection-filters">
                <button class="collection-filter-btn hp-filter active" data-filter="all">
                    <span class="filter-icon">📋</span> 全部
                </button>
                <button class="collection-filter-btn hp-filter" data-filter="collected">
                    <span class="filter-icon">✅</span> 已收集
                </button>
                <button class="collection-filter-btn hp-filter" data-filter="locked">
                    <span class="filter-icon">🔒</span> 未解锁
                </button>
            </div>

            <div class="collection-grid" id="hp-collection-grid">
                <!-- 动态生成哈利波特魔法生物卡片 -->
            </div>
        </div>

        <!-- 战斗模式页面 -->
        <div id="battle-page" class="page">
            <header class="battle-header">
                <button class="back-btn battle-exit-btn">← 退出</button>
                <div class="stage-info">
                    <span class="stage-label">关卡</span>
                    <span class="stage-number" id="battle-stage">1</span>
                    <span class="stage-total">/4</span>
                </div>
                <div class="battle-header-right">
                    <span class="card-counter" id="battle-card-count">🃏 0</span>
                    <span class="hp-hearts" id="player-hearts">❤️❤️❤️❤️❤️</span>
                </div>
            </header>

            <!-- 第三人称对战舞台 -->
            <div class="battle-arena">
                <!-- v18.0: 8层场景背景 -->
                <div class="scene-layer scene-sky"></div>
                <div class="scene-layer scene-stars"></div>
                <div class="scene-layer scene-far"></div>
                <div class="scene-layer scene-far-detail"></div>
                <div class="scene-layer scene-mid"></div>
                <div class="scene-layer scene-mid-detail"></div>
                <div class="scene-layer scene-effects"></div>
                <div class="scene-layer scene-atmosphere"></div>

                <div class="arena-ground"></div>
                <div class="hero-side">
                    <div class="hero-emoji hero-idle">🧙</div>
                    <div class="hero-name">勇者</div>
                </div>
                <div class="attack-zone"></div>
                <div class="enemy-side">
                    <div class="monster-aura" id="monster-aura"></div>
                    <div class="monster-emoji enemy-idle" id="monster-emoji">👻</div>
                    <div class="monster-name" id="monster-name">噗噗鬼</div>
                    <div class="monster-hp-bar">
                        <div class="monster-hp-fill" id="monster-hp-fill"></div>
                        <span class="monster-hp-text" id="monster-hp-text">5/5</span>
                    </div>
                    <div class="damage-numbers" id="damage-numbers"></div>
                </div>
                <!-- v17.0: Speed rank + move name overlays -->
                <div class="speed-rank-display" id="speed-rank-display"></div>
                <div class="move-name-popup" id="move-name-popup"></div>
            </div>

            <!-- 题目区域 -->
            <div class="battle-question-area">
                <div class="battle-question-card" id="battle-question-card">
                    <div class="battle-timer-wrapper">
                        <div class="battle-timer-bar" id="battle-timer-bar">
                            <div class="battle-timer-progress" id="battle-timer-progress"></div>
                        </div>
                        <div class="battle-timer-hint" id="battle-timer-hint">
                            <span class="timer-hint-icon">⏳</span>
                            <span class="timer-hint-text">时间到怪兽会攻击哦!</span>
                        </div>
                    </div>
                    <div class="battle-question-text" id="battle-question-text">6 × 7 = ?</div>
                </div>
                <div class="battle-combo" id="battle-combo">
                    <span class="combo-fire">🔥</span>
                    <span class="combo-count" id="combo-count">0</span>
                    <span class="combo-label">连击</span>
                </div>
            </div>

            <!-- 答题区域 -->
            <div class="battle-answer-area" id="battle-answer-area">
                <div class="battle-choices" id="battle-choices">
                    <button class="battle-choice-btn">42</button>
                    <button class="battle-choice-btn">48</button>
                    <button class="battle-choice-btn">36</button>
                    <button class="battle-choice-btn">54</button>
                </div>
                <div class="battle-input-mode hidden" id="battle-input-mode">
                    <input type="text" inputmode="decimal" class="battle-answer-input" id="battle-answer-input" placeholder="输入答案">
                    <button class="battle-submit-btn" id="battle-submit-btn">攻击!</button>
                </div>
            </div>

            <!-- 战斗反馈 -->
            <div class="battle-feedback" id="battle-feedback">
                <div class="battle-feedback-content">
                    <span class="battle-feedback-icon"></span>
                    <span class="battle-feedback-text"></span>
                </div>
            </div>

            <!-- 屏幕闪红效果 -->
            <div class="screen-flash" id="screen-flash"></div>
        </div>

        <!-- 战斗结果页 -->
        <div id="battle-result-page" class="page">
            <div class="battle-result-content">
                <div class="battle-result-icon" id="battle-result-icon">🎉</div>
                <h2 class="battle-result-title" id="battle-result-title">胜利！</h2>
                <p class="battle-result-subtitle" id="battle-result-subtitle">你成功击败了所有怪兽！</p>

                <div class="battle-result-stats">
                    <div class="battle-stat">
                        <span class="battle-stat-icon">👹</span>
                        <span class="battle-stat-value" id="result-monsters">4</span>
                        <span class="battle-stat-label">击败怪兽</span>
                    </div>
                    <div class="battle-stat">
                        <span class="battle-stat-icon">✅</span>
                        <span class="battle-stat-value" id="result-answers">18</span>
                        <span class="battle-stat-label">答对题数</span>
                    </div>
                    <div class="battle-stat">
                        <span class="battle-stat-icon">🔥</span>
                        <span class="battle-stat-value" id="result-max-combo">5</span>
                        <span class="battle-stat-label">最高连击</span>
                    </div>
                </div>

                <!-- v23.0: Chapter star display -->
                <div class="chapter-star-row" id="chapter-star-display" style="display:none;"></div>

                <!-- v23.0: Chapter accuracy display -->
                <div class="chapter-accuracy" id="chapter-accuracy-display" style="display:none;"></div>

                <div class="battle-result-score">
                    <span class="score-label">获得积分</span>
                    <span class="score-value" id="result-battle-score">+150</span>
                </div>

                <!-- v23.1: Chapter streak display -->
                <div class="chapter-streak-row" id="chapter-streak-display" style="display:none;"></div>

                <!-- v23.0: Chapter rewards display -->
                <div class="chapter-rewards-container" id="chapter-rewards-display" style="display:none;"></div>

                <!-- Default (non-chapter) actions -->
                <div class="battle-result-actions" id="default-result-actions">
                    <button class="battle-result-btn primary" id="battle-retry-btn">再战一次</button>
                    <button class="battle-result-btn" id="battle-home-btn">返回首页</button>
                </div>

                <!-- v23.0: Chapter result actions -->
                <div class="battle-result-actions" id="chapter-result-actions" style="display:none;"></div>
            </div>
        </div>

        <!-- 战斗失败页 -->
        <div id="battle-fail-page" class="page">
            <div class="battle-fail-content">
                <div class="battle-fail-icon">💔</div>
                <h2 class="battle-fail-title">挑战失败</h2>
                <p class="battle-fail-subtitle" id="battle-fail-subtitle">差一点就成功了！再试一次？</p>

                <div class="battle-fail-stats">
                    <div class="battle-stat">
                        <span class="battle-stat-icon">👹</span>
                        <span class="battle-stat-value" id="fail-monsters">2</span>
                        <span class="battle-stat-label">击败怪兽</span>
                    </div>
                    <div class="battle-stat">
                        <span class="battle-stat-icon">✅</span>
                        <span class="battle-stat-value" id="fail-answers">12</span>
                        <span class="battle-stat-label">答对题数</span>
                    </div>
                </div>

                <div class="battle-fail-actions">
                    <button class="battle-fail-btn primary" id="battle-retry-fail-btn">重新挑战</button>
                    <button class="battle-fail-btn" id="battle-home-fail-btn">返回首页</button>
                </div>
            </div>
        </div>

        <!-- 妖怪图鉴页 -->
        <div id="collection-page" class="page">
            <header class="collection-header">
                <button class="back-btn" id="collection-back-btn">← 返回</button>
                <h1>📖 妖怪图鉴</h1>
                <div class="collection-stats" id="collection-stats">0/53</div>
            </header>

            <div class="collection-banner">
                <div class="collection-banner-bg"></div>
                <div class="collection-banner-content">
                    <div class="collection-progress-ring">
                        <svg viewBox="0 0 80 80">
                            <circle cx="40" cy="40" r="35" class="progress-bg"/>
                            <circle cx="40" cy="40" r="35" class="progress-fill" id="collection-ring-fill"/>
                        </svg>
                        <span class="progress-percent" id="collection-percent">0%</span>
                    </div>
                    <div class="collection-banner-info">
                        <div class="collection-banner-title">收集进度</div>
                        <div class="collection-banner-count" id="collection-banner-count">0 / 53</div>
                        <div class="collection-banner-desc">击败妖怪收录图鉴</div>
                    </div>
                </div>
            </div>

            <div class="collection-filters">
                <button class="collection-filter-btn active" data-filter="all">
                    <span class="filter-icon">📋</span> 全部
                </button>
                <button class="collection-filter-btn" data-filter="collected">
                    <span class="filter-icon">✅</span> 已收集
                </button>
                <button class="collection-filter-btn" data-filter="locked">
                    <span class="filter-icon">🔒</span> 未解锁
                </button>
            </div>

            <div class="collection-grid" id="collection-grid">
                <!-- 动态生成妖怪卡片 -->
            </div>
        </div>

        <!-- 山海经图鉴页 -->
        <div id="shanhai-collection-page" class="page">
            <header class="collection-header shanhai-header">
                <button class="back-btn" id="shanhai-collection-back-btn">← 返回</button>
                <h1>📜 山海经图鉴</h1>
                <div class="collection-stats" id="shanhai-collection-stats">0/72</div>
            </header>

            <div class="collection-banner shanhai-banner">
                <div class="collection-banner-bg shanhai-banner-bg"></div>
                <div class="collection-banner-content">
                    <div class="collection-progress-ring">
                        <svg viewBox="0 0 80 80">
                            <circle cx="40" cy="40" r="35" class="progress-bg"/>
                            <circle cx="40" cy="40" r="35" class="progress-fill shanhai-ring" id="shanhai-ring-fill"/>
                        </svg>
                        <span class="progress-percent" id="shanhai-percent">0%</span>
                    </div>
                    <div class="collection-banner-info">
                        <div class="collection-banner-title">山海经收集进度</div>
                        <div class="collection-banner-count" id="shanhai-banner-count">0 / 72</div>
                        <div class="collection-banner-desc">征服分数小数，收录山海经妖怪</div>
                    </div>
                </div>
            </div>

            <div class="collection-filters">
                <button class="collection-filter-btn shanhai-filter active" data-filter="all">
                    <span class="filter-icon">📋</span> 全部
                </button>
                <button class="collection-filter-btn shanhai-filter" data-filter="collected">
                    <span class="filter-icon">✅</span> 已收集
                </button>
                <button class="collection-filter-btn shanhai-filter" data-filter="locked">
                    <span class="filter-icon">🔒</span> 未解锁
                </button>
            </div>

            <div class="collection-grid" id="shanhai-collection-grid">
                <!-- 动态生成山海经妖怪卡片 -->
            </div>
        </div>
    </div>

    <!-- 成就弹窗 -->
    <div class="achievement-popup hidden" id="achievement-popup">
        <div class="achievement-content">
            <span class="achievement-icon">🏅</span>
            <h3 class="achievement-title">获得成就！</h3>
            <p class="achievement-desc" id="achievement-desc">连续答对10题</p>
        </div>
    </div>

    <!-- 特效层 -->
    <div class="effects-layer" id="effects-layer"></div>

    <!-- 妖怪详情弹窗（全局层级） -->
    <div class="monster-detail-modal hidden" id="monster-detail-modal">
        <div class="monster-detail-overlay" id="monster-detail-overlay"></div>
        <div class="monster-detail-content">
            <button class="monster-detail-close" id="monster-detail-close">✕</button>
            <div class="monster-detail-hero" id="detail-hero-bg">
                <span class="monster-detail-emoji" id="detail-emoji">👻</span>
            </div>
            <div class="monster-detail-body">
                <div class="monster-detail-names">
                    <h2 class="monster-detail-name" id="detail-name">噗噗鬼</h2>
                    <span class="monster-detail-name-en" id="detail-name-en">Pupu Ghost</span>
                </div>
                <div class="monster-detail-type" id="detail-type">
                    <span class="type-badge ghost">幽灵系</span>
                </div>
                <div class="monster-detail-stats">
                    <div class="detail-stat">
                        <span class="detail-stat-icon">❤️</span>
                        <span class="detail-stat-value" id="detail-hp">3</span>
                        <span class="detail-stat-label">HP</span>
                    </div>
                    <div class="detail-stat">
                        <span class="detail-stat-icon" id="detail-attack-icon">👅</span>
                        <span class="detail-stat-value" id="detail-attack-name">舔舔攻击</span>
                        <span class="detail-stat-label">技能</span>
                    </div>
                </div>
                <div class="monster-detail-section">
                    <h3>🌟 特性 <span class="section-en">Trait</span></h3>
                    <p id="detail-trait">喜欢恶作剧的小幽灵</p>
                    <p class="en" id="detail-trait-en">A mischievous little ghost who loves pranks</p>
                </div>
                <div class="monster-detail-section">
                    <h3>📜 故事 <span class="section-en">Story</span></h3>
                    <p id="detail-story">噗噗鬼是数学世界里最可爱的小幽灵...</p>
                    <p class="en" id="detail-story-en">Pupu Ghost is the cutest little ghost in Math World...</p>
                </div>
                <button class="monster-detail-back-btn" id="monster-detail-back">返回图鉴</button>
            </div>
        </div>
    </div>

    <!-- 卡牌图鉴页 -->
    <div id="card-collection-page" class="page">
        <header class="page-header">
            <button class="back-btn" id="card-collection-back">← 返回</button>
            <h2>🃏 卡牌图鉴</h2>
        </header>
        <div class="card-collection-content">
            <div class="card-collection-header">
                <div class="card-progress">
                    <span>收集进度: </span>
                    <span id="card-collection-progress">0/124</span>
                </div>
                <div class="card-progress-bar">
                    <div class="card-progress-fill" id="card-progress-fill"></div>
                </div>
            </div>
            <div class="card-filter-tabs">
                <button class="card-filter-btn active" data-filter="all">全部</button>
                <button class="card-filter-btn" data-filter="N">N</button>
                <button class="card-filter-btn" data-filter="R">R</button>
                <button class="card-filter-btn" data-filter="SR">SR</button>
                <button class="card-filter-btn" data-filter="SSR">SSR</button>
                <button class="card-filter-btn" data-filter="UR">UR</button>
            </div>
            <div class="card-grid" id="card-grid"></div>
        </div>
        <div id="card-detail-modal"></div>
    </div>

    <!-- 试炼之塔大厅页 -->
    <div id="tower-lobby-page" class="page">
        <header class="page-header">
            <button class="back-btn" data-target="home">← 返回</button>
            <h2>🗼 试炼之塔</h2>
        </header>
        <div class="tower-lobby-wrapper">
            <div class="tower-lobby-hero">
                <div class="tower-icon">🗼</div>
                <p class="tower-subtitle">全题型混合挑战 · 30层递进 · 稀有卡牌</p>
            </div>
            <div id="tower-lobby-content">
                <!-- 动态渲染塔进度 -->
            </div>
        </div>
    </div>

    <script src="js/data.js?v=23.2"></script>
    <script src="js/shanhai-monsters.js?v=23.2"></script>
    <script src="js/xiyouji-monsters.js?v=23.2"></script>
    <script src="js/fengshen-monsters.js?v=23.2"></script>
    <script src="js/liaozhai-monsters.js?v=23.2"></script>
    <script src="js/hp-monsters.js?v=23.2"></script>
    <script src="js/core.js?v=23.2"></script>
    <script src="js/question-engine.js?v=23.2"></script>
    <script src="js/effects.js?v=23.2"></script>
    <script src="js/practice.js?v=23.2"></script>
    <script src="js/daily.js?v=23.2"></script>
    <script src="js/knowledge-data.js?v=23.2"></script>
    <script src="js/knowledge-tracker.js?v=23.2"></script>
    <script src="js/knowledge-ui.js?v=23.2"></script>
    <script src="js/ui-pages.js?v=23.2"></script>
    <script src="js/battle-data.js?v=23.2"></script>
    <script src="js/chapter-data.js?v=23.2"></script>
    <script src="js/card-data.js?v=23.2"></script>
    <script src="js/battle-arena.js?v=23.2"></script>
    <script src="js/monster-behavior.js?v=23.2"></script>
    <script src="js/card-system.js?v=23.2"></script>
    <script src="js/battle-collection.js?v=23.2"></script>
    <script src="js/tower-data.js?v=23.2"></script>
    <script src="js/hero-system.js?v=23.2"></script>
    <script src="js/combo-engine.js?v=23.2"></script>
    <script src="js/behavior-v2.js?v=23.2"></script>
    <script src="js/move-system.js?v=23.2"></script>
    <script src="js/tower-mode.js?v=23.2"></script>
    <script src="js/momentum-system.js?v=23.2"></script>
    <script src="js/chapter-system.js?v=23.2"></script>
    <script src="js/battle-combat.js?v=23.2"></script>
    <script src="js/app.js?v=23.2"></script>
</body>
</html>
